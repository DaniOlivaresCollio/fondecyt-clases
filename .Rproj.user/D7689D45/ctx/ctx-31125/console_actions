{
    "type": [
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        2,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        2
    ],
    "data": [
        "+ ",
        "         a07,",
        "+ ",
        "         a25, a25_esp, a25_esp_rec,",
        "+ ",
        "         a26,",
        "+ ",
        "         a27,",
        "+ ",
        "         # Skills",
        "+ ",
        "         a02,a02_rec,a03,a03_rec,",
        "+ ",
        "         ciuo08_clio = ciuo08,",
        "+ ",
        "         e05,",
        "+ ",
        "         # Autoridad / orgnización",
        "+ ",
        "         a15,",
        "+ ",
        "         a16,",
        "+ ",
        "         a17_01,a17_02,a17_03,a17_04,a17_05,a17_06,",
        "+ ",
        "         # formalidad",
        "+ ",
        "         a06,                                                  # boleta",
        "+ ",
        "         a10,                                                  # inicio de actividades",
        "+ ",
        "         a18,                                                  # contrato de trabajo escrito firmado",
        "+ ",
        "         # Dependent variables",
        "+ ",
        "         c01_01, c01_02, c01_03, c01_04, c01_05, c01_06,       # importancia de sindicatos",
        "+ ",
        "         c07_03, ",
        "+ ",
        "         b29,",
        "+ ",
        "         # Controls",
        "+ ",
        "         sexo = e01,",
        "+ ",
        "         edad = e02,",
        "+ ",
        "         b19,                                                  # hay sindicato en empresa",
        "+ ",
        "         b21,                                                  # afiliacion sindical",
        "+ ",
        "         c08                                                   # political id",
        "+ ",
        "         )# %>% ",
        "> ",
        "  #sjlabelled::set_na(.,na=c(-999,-888,-777))",
        "> ",
        "# Situación empleo",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    a07 = factor(",
        "+ ",
        "      as.numeric(a07),",
        "+ ",
        "      levels = 1:9,",
        "+ ",
        "      labels = c(",
        "+ ",
        "        \"1. Patrón(a) o empleador(a)\",",
        "+ ",
        "        \"2. Trabajador(a) por cuenta propia\",",
        "+ ",
        "        \"3. Empleado(a) u obrero(a) del sector público (Gobierno Central o Municipal)\",",
        "+ ",
        "        \"4. Empleado(a) u obrero(a) de empresas públicas\",",
        "+ ",
        "        \"5. Empleado(a) u obrero(a) del sector privado\",",
        "+ ",
        "        \"6. Servicio doméstico puertas adentro\",",
        "+ ",
        "        \"7. Servicio doméstico puertas afuera\",",
        "+ ",
        "        \"8. FF.AA. y del Orden\",",
        "+ ",
        "        \"9. Familiar no remunerado\"",
        "+ ",
        "      )",
        "+ ",
        "    )",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(a07 = \"Employment situation (a07)\")",
        "> ",
        "> ",
        "frq(data$a07)",
        "\u001B[31mEmployment situation (a07) (x)\u001B[39m\u001B[34m <categorical>\u001B[39m \n\u001B[34m# total N=3048 valid N=3048 mean=3.79 sd=1.67\u001B[39m\n\nValue                                                                        |    N | Raw % | Valid % | Cum. %\n--------------------------------------------------------------------------------------------------------------\n1. Patrón(a) o empleador(a)                                                  |  345 | 11.32 |   11.32 |  11.32\n2. Trabajador(a) por cuenta propia                     ",
        "                      |  598 | 19.62 |   19.62 |  30.94\n3. Empleado(a) u obrero(a) del sector público (Gobierno Central o Municipal) |  251 |  8.23 |    8.23 |  39.17\n4. Empleado(a) u obrero(a) de empresas públicas                              |  337 | 11.06 |   11.06 |  50.23\n5. Empleado(a) u obrero(a) del sector privado                                | 1370 | 44.95 |   44.95 |  95.18\n6. Servicio doméstico puertas adentro                                        |   21 |  0.69 |    0.69 |  95.87\n7. Servic",
        "io doméstico puertas afuera                                         |  101 |  3.31 |    3.31 |  99.18\n8. FF.AA. y del Orden                                                        |   13 |  0.43 |    0.43 |  99.61\n9. Familiar no remunerado                                                    |   12 |  0.39 |    0.39 | 100.00\n<NA>                                                                         |    0 |  0.00 |    <NA> |   <NA>\n",
        "> ",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    relation_mop = case_when(",
        "+ ",
        "      as_numeric(a07) == 1 ~ 1,",
        "+ ",
        "      as_numeric(a07) == 2 ~ 2,",
        "+ ",
        "      as_numeric(a07) >= 3 ~ 3,",
        "+ ",
        "      TRUE ~ NA_real_",
        "+ ",
        "      ),",
        "+ ",
        "    relation_mop = factor(",
        "+ ",
        "      relation_mop,",
        "+ ",
        "      levels = 1:3,",
        "+ ",
        "      labels = c(",
        "+ ",
        "        \"1. Employers\",",
        "+ ",
        "        \"2. Self-Employed\",",
        "+ ",
        "        \"3. Salaried\"",
        "+ ",
        "      )",
        "+ ",
        "    )",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(relation_mop = \"Relation with Means of Production\")",
        "> ",
        "> ",
        "frq(data$relation_mop)",
        "\u001B[31mRelation with Means of Production (x)\u001B[39m\u001B[34m <categorical>\u001B[39m \n\u001B[34m# total N=3048 valid N=3048 mean=2.58 sd=0.69\u001B[39m\n\nValue            |    N | Raw % | Valid % | Cum. %\n--------------------------------------------------\n1. Employers     |  345 | 11.32 |   11.32 |  11.32\n2. Self-Employed |  598 | 19.62 |   19.62 |  30.94\n3. Salaried      | 2105 | 69.06 |   69.06 | 100.00\n<NA>             |    0 |  0.00 |    <NA> |   <NA>\n",
        "> ",
        "frq(data$a26)",
        "\u001B[31mx\u001B[39m\u001B[34m <numeric>\u001B[39m \n\u001B[34m# total N=3048 valid N=3048 mean=-73.62 sd=251.41\u001B[39m\n\nValue |   N | Raw % | Valid % | Cum. %\n--------------------------------------\n -999 |   8 |  0.26 |    0.26 |   0.26\n -888 | 255 |  8.37 |    8.37 |   8.63\n    1 | 783 | 25.69 |   25.69 |  34.32\n    2 | 486 | 15.94 |   15.94 |  50.26\n    3 | 277 |  9.09 |    9.09 |  59.35\n    4 | 316 | 10.37 |   10.37 |  69.72\n    5 | 291 |  9.55 |    9.55 |  79.27\n    6 | 183 |  6.00 |    6.00 |  85.27\n    7 | 150 |  4.92 |    4.9",
        "2 |  90.19\n    8 | 113 |  3.71 |    3.71 |  93.90\n    9 | 186 |  6.10 |    6.10 | 100.00\n <NA> |   0 |  0.00 |    <NA> |   <NA>\n",
        "> ",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    company_size = case_when(",
        "+ ",
        "      a26 %in% c(1) ~ 1,",
        "+ ",
        "      a26 %in% c(2, 3) ~ 2,",
        "+ ",
        "      a26 %in% c(4, 5) ~ 3,",
        "+ ",
        "      a26 %in% c(6, 7) ~ 4,",
        "+ ",
        "      a26 %in% c(8, 9) ~ 5,",
        "+ ",
        "      TRUE ~ NA_real_",
        "+ ",
        "    ),",
        "+ ",
        "    company_size = factor(",
        "+ ",
        "      company_size, ",
        "+ ",
        "      levels = 1:5, ",
        "+ ",
        "      labels = c(",
        "+ ",
        "        \"Solo\",",
        "+ ",
        "        \"2-9\",",
        "+ ",
        "        \"10-49\",",
        "+ ",
        "        \"50-199\",",
        "+ ",
        "        \"200 or more\"),",
        "+ ",
        "      ordered = TRUE",
        "+ ",
        "    )",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(company_size = \"Company Size\")",
        "> ",
        "> ",
        "frq(data$company_size)",
        "\u001B[31mCompany Size (x)\u001B[39m\u001B[34m <ordinal>\u001B[39m \n\u001B[34m# total N=3048 valid N=2785 mean=2.50 sd=1.30\u001B[39m\n\nValue       |   N | Raw % | Valid % | Cum. %\n--------------------------------------------\nSolo        | 783 | 25.69 |   28.11 |  28.11\n2-9         | 763 | 25.03 |   27.40 |  55.51\n10-49       | 607 | 19.91 |   21.80 |  77.31\n50-199      | 333 | 10.93 |   11.96 |  89.26\n200 or more | 299 |  9.81 |   10.74 | 100.00\n<NA>        | 263 |  8.63 |    <NA> |   <NA>\n",
        "> ",
        "frq(data$a27)",
        "\u001B[31mx\u001B[39m\u001B[34m <numeric>\u001B[39m \n\u001B[34m# total N=3048 valid N=3048 mean=-15.76 sd=129.92\u001B[39m\n\nValue |   N | Raw % | Valid % | Cum. %\n--------------------------------------\n -999 |   8 |  0.26 |    0.26 |   0.26\n -888 |  56 |  1.84 |    1.84 |   2.10\n    1 | 851 | 27.92 |   27.92 |  30.02\n    2 | 590 | 19.36 |   19.36 |  49.38\n    3 | 353 | 11.58 |   11.58 |  60.96\n    4 | 358 | 11.75 |   11.75 |  72.70\n    5 | 341 | 11.19 |   11.19 |  83.89\n    6 | 198 |  6.50 |    6.50 |  90.39\n    7 | 154 |  5.05 |    5.0",
        "5 |  95.44\n    8 |  71 |  2.33 |    2.33 |  97.77\n    9 |  68 |  2.23 |    2.23 | 100.00\n <NA> |   0 |  0.00 |    <NA> |   <NA>\n",
        "> ",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    workplace_size = case_when(",
        "+ ",
        "      a27 %in% c(1) ~ 1,",
        "+ ",
        "      a27 %in% c(2, 3) ~ 2,",
        "+ ",
        "      a27 %in% c(4, 5) ~ 3,",
        "+ ",
        "      a27 %in% c(6, 7) ~ 4,",
        "+ ",
        "      a27 %in% c(8, 9) ~ 5,",
        "+ ",
        "      TRUE ~ NA_real_",
        "+ ",
        "    ),",
        "+ ",
        "    workplace_size = factor(",
        "+ ",
        "      workplace_size, ",
        "+ ",
        "      levels = 1:5, ",
        "+ ",
        "      labels = c(",
        "+ ",
        "        \"Solo\",",
        "+ ",
        "        \"2-9\",",
        "+ ",
        "        \"10-49\",",
        "+ ",
        "        \"50-199\",",
        "+ ",
        "        \"200 or more\"),",
        "+ ",
        "      ordered = TRUE",
        "+ ",
        "    )",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(workplace_size = \"Workplace Size\")",
        "> ",
        "> ",
        "frq(data$workplace_size)",
        "\u001B[31mWorkplace Size (x)\u001B[39m\u001B[34m <ordinal>\u001B[39m \n\u001B[34m# total N=3048 valid N=2984 mean=2.32 sd=1.14\u001B[39m\n\nValue       |   N | Raw % | Valid % | Cum. %\n--------------------------------------------\nSolo        | 851 | 27.92 |   28.52 |  28.52\n2-9         | 943 | 30.94 |   31.60 |  60.12\n10-49       | 699 | 22.93 |   23.42 |  83.55\n50-199      | 352 | 11.55 |   11.80 |  95.34\n200 or more | 139 |  4.56 |    4.66 | 100.00\n<NA>        |  64 |  2.10 |    <NA> |   <NA>\n",
        "> ",
        "table(data$relation_mop,data$company_size)",
        "                  \n                   Solo 2-9 10-49 50-199 200 or more\n  1. Employers      141 128    47     12          11\n  2. Self-Employed  402 140    20      4           9\n  3. Salaried       240 495   540    317         279\n",
        "> ",
        "table(data$relation_mop,data$workplace_size)",
        "                  \n                   Solo 2-9 10-49 50-199 200 or more\n  1. Employers      144 131    48     13           4\n  2. Self-Employed  411 151    22      7           2\n  3. Salaried       296 661   629    332         133\n",
        "> ",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    owners = case_when(",
        "+ ",
        "      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) == 1 | (is.na(company_size) & as.numeric(workplace_size) == 1)) ~ 1,",
        "+ ",
        "      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) == 2 | (is.na(company_size) & as.numeric(workplace_size) == 2)) ~ 2,",
        "+ ",
        "      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) >= 3 | (is.na(company_size) & as.numeric(workplace_size) >= 3)) ~ 3,",
        "+ ",
        "      TRUE ~ NA_real_",
        "+ ",
        "    ),",
        "+ ",
        "    owners = factor(",
        "+ ",
        "      owners,",
        "+ ",
        "      levels = 1:3,",
        "+ ",
        "      labels = c(",
        "+ ",
        "        \"1. Solo Self-Employed\",",
        "+ ",
        "        \"2. Small employers\",",
        "+ ",
        "        \"3. Employers\"",
        "+ ",
        "      )",
        "+ ",
        "    )",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(owners = \"Owners\")",
        "> ",
        "> ",
        "frq(data$owners)",
        "\u001B[31mOwners (x)\u001B[39m\u001B[34m <categorical>\u001B[39m \n\u001B[34m# total N=3048 valid N=935 mean=1.53 sd=0.69\u001B[39m\n\nValue                 |    N | Raw % | Valid % | Cum. %\n-------------------------------------------------------\n1. Solo Self-Employed |  551 | 18.08 |   58.93 |  58.93\n2. Small employers    |  276 |  9.06 |   29.52 |  88.45\n3. Employers          |  108 |  3.54 |   11.55 | 100.00\n<NA>                  | 2113 | 69.32 |    <NA> |   <NA>\n",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    owners2 = case_when(",
        "+ ",
        "      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) == 1 | (is.na(company_size) & as.numeric(workplace_size) == 1)) ~ 1,",
        "+ ",
        "      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) %in% 2:3 | (is.na(company_size) & as.numeric(workplace_size) %in% 2:3)) ~ 2,",
        "+ ",
        "      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) >= 4 | (is.na(company_size) & as.numeric(workplace_size) >= 4)) ~ 3,",
        "+ ",
        "      TRUE ~ NA_real_",
        "+ ",
        "    ),",
        "+ ",
        "    owners2 = factor(",
        "+ ",
        "      owners2,",
        "+ ",
        "      levels = 1:3,",
        "+ ",
        "      labels = c(",
        "+ ",
        "        \"1. Solo Self-Employed\",",
        "+ ",
        "        \"2. Small employers\",",
        "+ ",
        "        \"3. Capitalists\"",
        "+ ",
        "      )",
        "+ ",
        "    )",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(owners2 = \"Owners 2\")",
        "> ",
        "> ",
        "frq(data$owners2)",
        "\u001B[31mOwners 2 (x)\u001B[39m\u001B[34m <categorical>\u001B[39m \n\u001B[34m# total N=3048 valid N=935 mean=1.45 sd=0.57\u001B[39m\n\nValue                 |    N | Raw % | Valid % | Cum. %\n-------------------------------------------------------\n1. Solo Self-Employed |  551 | 18.08 |   58.93 |  58.93\n2. Small employers    |  348 | 11.42 |   37.22 |  96.15\n3. Capitalists        |   36 |  1.18 |    3.85 | 100.00\n<NA>                  | 2113 | 69.32 |    <NA> |   <NA>\n",
        "> ",
        "frq(data$e05)",
        "\u001B[31mx\u001B[39m\u001B[34m <numeric>\u001B[39m \n\u001B[34m# total N=3048 valid N=3048 mean=-2.37 sd=88.97\u001B[39m\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n -999 |   13 |  0.43 |    0.43 |   0.43\n -888 |   14 |  0.46 |    0.46 |   0.89\n    1 |   28 |  0.92 |    0.92 |   1.80\n    2 |   95 |  3.12 |    3.12 |   4.92\n    3 |  215 |  7.05 |    7.05 |  11.98\n    4 |  201 |  6.59 |    6.59 |  18.57\n    5 | 1062 | 34.84 |   34.84 |  53.41\n    6 |  178 |  5.84 |    5.84 |  59.25\n    7 |  440 | 14.44",
        " |   14.44 |  73.69\n    8 |  205 |  6.73 |    6.73 |  80.41\n    9 |  531 | 17.42 |   17.42 |  97.83\n   10 |   66 |  2.17 |    2.17 | 100.00\n <NA> |    0 |  0.00 |    <NA> |   <NA>\n",
        "> ",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    educ = ifelse(e05 %in% c(-999, -888), NA, e05)",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(educ = \"Educational level\")",
        "> ",
        "> ",
        "frq(data$educ)",
        "\u001B[31mEducational level (x)\u001B[39m\u001B[34m <numeric>\u001B[39m \n\u001B[34m# total N=3048 valid N=3021 mean=6.03 sd=2.08\u001B[39m\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n    1 |   28 |  0.92 |    0.93 |   0.93\n    2 |   95 |  3.12 |    3.14 |   4.07\n    3 |  215 |  7.05 |    7.12 |  11.19\n    4 |  201 |  6.59 |    6.65 |  17.84\n    5 | 1062 | 34.84 |   35.15 |  53.00\n    6 |  178 |  5.84 |    5.89 |  58.89\n    7 |  440 | 14.44 |   14.56 |  73.45\n    8 |  205 |  6.73 |    6.79 |  80.24\n  ",
        "  9 |  531 | 17.42 |   17.58 |  97.82\n   10 |   66 |  2.17 |    2.18 | 100.00\n <NA> |   27 |  0.89 |    <NA> |   <NA>\n",
        "> ",
        "# Preparar variables necesarias",
        "> ",
        "> ",
        "## Crear la glosa concatenada",
        "> ",
        "data$glosa_ciuo08 <- paste(data$a02, data$a03, sep = \" \")",
        "> ",
        "> ",
        "## Crear isco a 2 dígitos",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    ciuo08_clio_2d = as.numeric(substr(ciuo08_clio, 1, 2))",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(ciuo08_clio_2d = \"ISCO-08: 2 digits\")",
        "> ",
        "> ",
        "frq(data$ciuo08_clio_2d)",
        "\u001B[31mISCO-08: 2 digits (x)\u001B[39m\u001B[34m <numeric>\u001B[39m \n\u001B[34m# total N=3048 valid N=3048 mean=54.09 sd=26.33\u001B[39m\n\nValue |   N | Raw % | Valid % | Cum. %\n--------------------------------------\n   -9 |  42 |  1.38 |    1.38 |   1.38\n    1 |  12 |  0.39 |    0.39 |   1.77\n   11 |  20 |  0.66 |    0.66 |   2.43\n   12 |  28 |  0.92 |    0.92 |   3.35\n   13 |  44 |  1.44 |    1.44 |   4.79\n   14 |  11 |  0.36 |    0.36 |   5.15\n   21 |  62 |  2.03 |    2.03 |   7.19\n   22 | 200 |  6.56 |    6.56 |  13.75\n   23 | 14",
        "0 |  4.59 |    4.59 |  18.34\n   24 |  37 |  1.21 |    1.21 |  19.55\n   25 |  12 |  0.39 |    0.39 |  19.95\n   26 | 114 |  3.74 |    3.74 |  23.69\n   31 |  28 |  0.92 |    0.92 |  24.61\n   32 |  27 |  0.89 |    0.89 |  25.49\n   33 | 116 |  3.81 |    3.81 |  29.30\n   34 |  34 |  1.12 |    1.12 |  30.41\n   35 |   6 |  0.20 |    0.20 |  30.61\n   36 |  11 |  0.36 |    0.36 |  30.97\n   41 |   2 |  0.07 |    0.07 |  31.04\n   42 |  13 |  0.43 |    0.43 |  31.46\n   43 |  39 |  1.28 |    1.28 |  32.74\n   44 |   4 |  ",
        "0.13 |    0.13 |  32.87\n   51 | 189 |  6.20 |    6.20 |  39.07\n   52 | 590 | 19.36 |   19.36 |  58.43\n   53 |  57 |  1.87 |    1.87 |  60.30\n   54 | 153 |  5.02 |    5.02 |  65.32\n   55 |   2 |  0.07 |    0.07 |  65.39\n   61 |  28 |  0.92 |    0.92 |  66.31\n   62 |   1 |  0.03 |    0.03 |  66.34\n   63 |   3 |  0.10 |    0.10 |  66.44\n   71 |  60 |  1.97 |    1.97 |  68.41\n   72 | 107 |  3.51 |    3.51 |  71.92\n   73 |  17 |  0.56 |    0.56 |  72.47\n   74 |  16 |  0.52 |    0.52 |  73.00\n   75 |  58 |  1.90 ",
        "|    1.90 |  74.90\n   81 |  25 |  0.82 |    0.82 |  75.72\n   83 | 186 |  6.10 |    6.10 |  81.82\n   91 | 202 |  6.63 |    6.63 |  88.45\n   92 |  91 |  2.99 |    2.99 |  91.44\n   93 | 153 |  5.02 |    5.02 |  96.46\n   94 |  82 |  2.69 |    2.69 |  99.15\n   95 |   1 |  0.03 |    0.03 |  99.18\n   96 |  25 |  0.82 |    0.82 | 100.00\n <NA> |   0 |  0.00 |    <NA> |   <NA>\n",
        "> ",
        "## Armar tabla filtrando a los NA",
        "> ",
        "tabla_ciuo08_999 <- data %>%",
        "+ ",
        "  filter(as.numeric(ciuo08_clio_2d) < 1) %>%",
        "+ ",
        "  select(ciuo08_clio,",
        "+ ",
        "         ciuo08_clio_2d,",
        "+ ",
        "         glosa_ciuo08, ",
        "+ ",
        "         a03,",
        "+ ",
        "         supervisa = a16, ",
        "+ ",
        "         educ = e05, ",
        "+ ",
        "         rama = a25, ",
        "+ ",
        "         a25_esp, ",
        "+ ",
        "         rama_esp = a25_esp_rec)",
        "> ",
        "## Pasar tabla a word",
        "> ",
        "tabla_ft <- flextable(tabla_ciuo08_999)",
        "> ",
        "read_docx() %>%",
        "+ ",
        "  body_add_flextable(value = tabla_ft) %>%",
        "+ ",
        "  print(target = \"output/tabla_ciuo08_999.docx\")",
        "> ",
        "## Revisar NA con API del INE",
        "> ",
        "## Enviar la consulta al servidor",
        "> ",
        "request <-  httr::POST(\"https://rapps.ine.cl:9292/predict\", ",
        "+ ",
        "                       encode = \"json\",",
        "+ ",
        "                       body =  list(text = tabla_ciuo08_999$glosa_ciuo08,",
        "+ ",
        "                                    classification = \"ciuo\",",
        "+ ",
        "                                    digits = 2))",
        "Initiating curl with CURL_SSL_BACKEND: openssl\n\u001BG1;\u001BH1;Error\u001Bh in curl::curl_fetch_memory(url, handle = handle) : \n  Timeout was reached [rapps.ine.cl]: Failed to connect to rapps.ine.cl port 9292 after 10004 ms: Timeout was reached\n\u001Bg",
        "> ",
        "usethis::edit_r_environ()",
        "\u001BG3;\u001B[31m☐\u001B[39m Modify \u001B]8;;file://C:/Users/danie/OneDrive/Documents/.Renviron\u0007\u001B[34mC:/Users/danie/OneDrive/Documents/.Renviron\u001B[39m\u001B]8;;\u0007.\n\u001Bg\u001BG3;\u001B[31m☐\u001B[39m Restart R for changes to take effect.\n\u001Bg",
        "\u001BG3;Restarting R session...\u001Bg",
        "> ",
        "rm(list=ls())",
        "> ",
        "options(scipen = 999)",
        "> ",
        "> ",
        "library(pacman)",
        "> ",
        "p_load(bookdown,",
        "+ ",
        "       car,",
        "+ ",
        "       flextable,",
        "+ ",
        "       forcats,",
        "+ ",
        "       ggalluvial,",
        "+ ",
        "       ggplot2,",
        "+ ",
        "       ggrepel,",
        "+ ",
        "       gridExtra,",
        "+ ",
        "       httr,",
        "+ ",
        "       kableExtra,",
        "+ ",
        "       knitr,",
        "+ ",
        "       labelled,",
        "+ ",
        "       lubridate,",
        "+ ",
        "       officer,",
        "+ ",
        "       psych,",
        "+ ",
        "       purrr,",
        "+ ",
        "       readr,",
        "+ ",
        "       readxl,",
        "+ ",
        "       shadowtext,",
        "+ ",
        "       sjmisc,",
        "+ ",
        "       sjPlot,",
        "+ ",
        "       sjlabelled,",
        "+ ",
        "       statar,",
        "+ ",
        "       stringr,",
        "+ ",
        "       survey,        # diseño survey",
        "+ ",
        "       srvyr,         # diseño survey con tidy",
        "+ ",
        "       tidyverse,",
        "+ ",
        "       tinytex,",
        "+ ",
        "       viridis,",
        "+ ",
        "       httr",
        "+ ",
        "       )",
        "> ",
        "load(\"input/data/datos-conclat.Rdata\")",
        "> ",
        "data_raw <- data",
        "> ",
        "> ",
        "data <- data %>%",
        "+ ",
        "  rename(",
        "+ ",
        "    ciuo08_clio = ciuo08,",
        "+ ",
        "    sexo = e01,",
        "+ ",
        "    edad = e02",
        "+ ",
        "  )",
        "> ",
        "data_select <- data_raw %>% ",
        "+ ",
        "  select(id,",
        "+ ",
        "         rake_wb2,",
        "+ ",
        "         # Relación con los medios de producción",
        "+ ",
        "         a07,",
        "+ ",
        "         a25, a25_esp, a25_esp_rec,",
        "+ ",
        "         a26,",
        "+ ",
        "         a27,",
        "+ ",
        "         # Skills",
        "+ ",
        "         a02,a02_rec,a03,a03_rec,",
        "+ ",
        "         ciuo08_clio = ciuo08,",
        "+ ",
        "         e05,",
        "+ ",
        "         # Autoridad / orgnización",
        "+ ",
        "         a15,",
        "+ ",
        "         a16,",
        "+ ",
        "         a17_01,a17_02,a17_03,a17_04,a17_05,a17_06,",
        "+ ",
        "         # formalidad",
        "+ ",
        "         a06,                                                  # boleta",
        "+ ",
        "         a10,                                                  # inicio de actividades",
        "+ ",
        "         a18,                                                  # contrato de trabajo escrito firmado",
        "+ ",
        "         # Dependent variables",
        "+ ",
        "         c01_01, c01_02, c01_03, c01_04, c01_05, c01_06,       # importancia de sindicatos",
        "+ ",
        "         c07_03, ",
        "+ ",
        "         b29,",
        "+ ",
        "         # Controls",
        "+ ",
        "         sexo = e01,",
        "+ ",
        "         edad = e02,",
        "+ ",
        "         b19,                                                  # hay sindicato en empresa",
        "+ ",
        "         b21,                                                  # afiliacion sindical",
        "+ ",
        "         c08                                                   # political id",
        "+ ",
        "         )# %>% ",
        "> ",
        "  #sjlabelled::set_na(.,na=c(-999,-888,-777))",
        "> ",
        "# Situación empleo",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    a07 = factor(",
        "+ ",
        "      as.numeric(a07),",
        "+ ",
        "      levels = 1:9,",
        "+ ",
        "      labels = c(",
        "+ ",
        "        \"1. Patrón(a) o empleador(a)\",",
        "+ ",
        "        \"2. Trabajador(a) por cuenta propia\",",
        "+ ",
        "        \"3. Empleado(a) u obrero(a) del sector público (Gobierno Central o Municipal)\",",
        "+ ",
        "        \"4. Empleado(a) u obrero(a) de empresas públicas\",",
        "+ ",
        "        \"5. Empleado(a) u obrero(a) del sector privado\",",
        "+ ",
        "        \"6. Servicio doméstico puertas adentro\",",
        "+ ",
        "        \"7. Servicio doméstico puertas afuera\",",
        "+ ",
        "        \"8. FF.AA. y del Orden\",",
        "+ ",
        "        \"9. Familiar no remunerado\"",
        "+ ",
        "      )",
        "+ ",
        "    )",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(a07 = \"Employment situation (a07)\")",
        "> ",
        "> ",
        "frq(data$a07)",
        "\u001B[31mEmployment situation (a07) (x)\u001B[39m\u001B[34m <categorical>\u001B[39m \n\u001B[34m# total N=3048 valid N=3048 mean=3.79 sd=1.67\u001B[39m\n\nValue                                                                        |    N | Raw % | Valid % | Cum. %\n--------------------------------------------------------------------------------------------------------------\n1. Patrón(a) o empleador(a)                                                  |  345 | 11.32 |   11.32 |  11.32\n2. Trabajador(a) por cuenta propia                     ",
        "                      |  598 | 19.62 |   19.62 |  30.94\n3. Empleado(a) u obrero(a) del sector público (Gobierno Central o Municipal) |  251 |  8.23 |    8.23 |  39.17\n4. Empleado(a) u obrero(a) de empresas públicas                              |  337 | 11.06 |   11.06 |  50.23\n5. Empleado(a) u obrero(a) del sector privado                                | 1370 | 44.95 |   44.95 |  95.18\n6. Servicio doméstico puertas adentro                                        |   21 |  0.69 |    0.69 |  95.87\n7. Servic",
        "io doméstico puertas afuera                                         |  101 |  3.31 |    3.31 |  99.18\n8. FF.AA. y del Orden                                                        |   13 |  0.43 |    0.43 |  99.61\n9. Familiar no remunerado                                                    |   12 |  0.39 |    0.39 | 100.00\n<NA>                                                                         |    0 |  0.00 |    <NA> |   <NA>\n",
        "> ",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    relation_mop = case_when(",
        "+ ",
        "      as_numeric(a07) == 1 ~ 1,",
        "+ ",
        "      as_numeric(a07) == 2 ~ 2,",
        "+ ",
        "      as_numeric(a07) >= 3 ~ 3,",
        "+ ",
        "      TRUE ~ NA_real_",
        "+ ",
        "      ),",
        "+ ",
        "    relation_mop = factor(",
        "+ ",
        "      relation_mop,",
        "+ ",
        "      levels = 1:3,",
        "+ ",
        "      labels = c(",
        "+ ",
        "        \"1. Employers\",",
        "+ ",
        "        \"2. Self-Employed\",",
        "+ ",
        "        \"3. Salaried\"",
        "+ ",
        "      )",
        "+ ",
        "    )",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(relation_mop = \"Relation with Means of Production\")",
        "> ",
        "> ",
        "frq(data$relation_mop)",
        "\u001B[31mRelation with Means of Production (x)\u001B[39m\u001B[34m <categorical>\u001B[39m \n\u001B[34m# total N=3048 valid N=3048 mean=2.58 sd=0.69\u001B[39m\n\nValue            |    N | Raw % | Valid % | Cum. %\n--------------------------------------------------\n1. Employers     |  345 | 11.32 |   11.32 |  11.32\n2. Self-Employed |  598 | 19.62 |   19.62 |  30.94\n3. Salaried      | 2105 | 69.06 |   69.06 | 100.00\n<NA>             |    0 |  0.00 |    <NA> |   <NA>\n",
        "> ",
        "frq(data$a26)",
        "\u001B[31mx\u001B[39m\u001B[34m <numeric>\u001B[39m \n\u001B[34m# total N=3048 valid N=3048 mean=-73.62 sd=251.41\u001B[39m\n\nValue |   N | Raw % | Valid % | Cum. %\n--------------------------------------\n -999 |   8 |  0.26 |    0.26 |   0.26\n -888 | 255 |  8.37 |    8.37 |   8.63\n    1 | 783 | 25.69 |   25.69 |  34.32\n    2 | 486 | 15.94 |   15.94 |  50.26\n    3 | 277 |  9.09 |    9.09 |  59.35\n    4 | 316 | 10.37 |   10.37 |  69.72\n    5 | 291 |  9.55 |    9.55 |  79.27\n    6 | 183 |  6.00 |    6.00 |  85.27\n    7 | 150 |  4.92 |    4.9",
        "2 |  90.19\n    8 | 113 |  3.71 |    3.71 |  93.90\n    9 | 186 |  6.10 |    6.10 | 100.00\n <NA> |   0 |  0.00 |    <NA> |   <NA>\n",
        "> ",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    company_size = case_when(",
        "+ ",
        "      a26 %in% c(1) ~ 1,",
        "+ ",
        "      a26 %in% c(2, 3) ~ 2,",
        "+ ",
        "      a26 %in% c(4, 5) ~ 3,",
        "+ ",
        "      a26 %in% c(6, 7) ~ 4,",
        "+ ",
        "      a26 %in% c(8, 9) ~ 5,",
        "+ ",
        "      TRUE ~ NA_real_",
        "+ ",
        "    ),",
        "+ ",
        "    company_size = factor(",
        "+ ",
        "      company_size, ",
        "+ ",
        "      levels = 1:5, ",
        "+ ",
        "      labels = c(",
        "+ ",
        "        \"Solo\",",
        "+ ",
        "        \"2-9\",",
        "+ ",
        "        \"10-49\",",
        "+ ",
        "        \"50-199\",",
        "+ ",
        "        \"200 or more\"),",
        "+ ",
        "      ordered = TRUE",
        "+ ",
        "    )",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(company_size = \"Company Size\")",
        "> ",
        "> ",
        "frq(data$company_size)",
        "\u001B[31mCompany Size (x)\u001B[39m\u001B[34m <ordinal>\u001B[39m \n\u001B[34m# total N=3048 valid N=2785 mean=2.50 sd=1.30\u001B[39m\n\nValue       |   N | Raw % | Valid % | Cum. %\n--------------------------------------------\nSolo        | 783 | 25.69 |   28.11 |  28.11\n2-9         | 763 | 25.03 |   27.40 |  55.51\n10-49       | 607 | 19.91 |   21.80 |  77.31\n50-199      | 333 | 10.93 |   11.96 |  89.26\n200 or more | 299 |  9.81 |   10.74 | 100.00\n<NA>        | 263 |  8.63 |    <NA> |   <NA>\n",
        "> ",
        "frq(data$a27)",
        "\u001B[31mx\u001B[39m\u001B[34m <numeric>\u001B[39m \n\u001B[34m# total N=3048 valid N=3048 mean=-15.76 sd=129.92\u001B[39m\n\nValue |   N | Raw % | Valid % | Cum. %\n--------------------------------------\n -999 |   8 |  0.26 |    0.26 |   0.26\n -888 |  56 |  1.84 |    1.84 |   2.10\n    1 | 851 | 27.92 |   27.92 |  30.02\n    2 | 590 | 19.36 |   19.36 |  49.38\n    3 | 353 | 11.58 |   11.58 |  60.96\n    4 | 358 | 11.75 |   11.75 |  72.70\n    5 | 341 | 11.19 |   11.19 |  83.89\n    6 | 198 |  6.50 |    6.50 |  90.39\n    7 | 154 |  5.05 |    5.0",
        "5 |  95.44\n    8 |  71 |  2.33 |    2.33 |  97.77\n    9 |  68 |  2.23 |    2.23 | 100.00\n <NA> |   0 |  0.00 |    <NA> |   <NA>\n",
        "> ",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    workplace_size = case_when(",
        "+ ",
        "      a27 %in% c(1) ~ 1,",
        "+ ",
        "      a27 %in% c(2, 3) ~ 2,",
        "+ ",
        "      a27 %in% c(4, 5) ~ 3,",
        "+ ",
        "      a27 %in% c(6, 7) ~ 4,",
        "+ ",
        "      a27 %in% c(8, 9) ~ 5,",
        "+ ",
        "      TRUE ~ NA_real_",
        "+ ",
        "    ),",
        "+ ",
        "    workplace_size = factor(",
        "+ ",
        "      workplace_size, ",
        "+ ",
        "      levels = 1:5, ",
        "+ ",
        "      labels = c(",
        "+ ",
        "        \"Solo\",",
        "+ ",
        "        \"2-9\",",
        "+ ",
        "        \"10-49\",",
        "+ ",
        "        \"50-199\",",
        "+ ",
        "        \"200 or more\"),",
        "+ ",
        "      ordered = TRUE",
        "+ ",
        "    )",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(workplace_size = \"Workplace Size\")",
        "> ",
        "> ",
        "frq(data$workplace_size)",
        "\u001B[31mWorkplace Size (x)\u001B[39m\u001B[34m <ordinal>\u001B[39m \n\u001B[34m# total N=3048 valid N=2984 mean=2.32 sd=1.14\u001B[39m\n\nValue       |   N | Raw % | Valid % | Cum. %\n--------------------------------------------\nSolo        | 851 | 27.92 |   28.52 |  28.52\n2-9         | 943 | 30.94 |   31.60 |  60.12\n10-49       | 699 | 22.93 |   23.42 |  83.55\n50-199      | 352 | 11.55 |   11.80 |  95.34\n200 or more | 139 |  4.56 |    4.66 | 100.00\n<NA>        |  64 |  2.10 |    <NA> |   <NA>\n",
        "> ",
        "table(data$relation_mop,data$company_size)",
        "                  \n                   Solo 2-9 10-49 50-199 200 or more\n  1. Employers      141 128    47     12          11\n  2. Self-Employed  402 140    20      4           9\n  3. Salaried       240 495   540    317         279\n",
        "> ",
        "table(data$relation_mop,data$workplace_size)",
        "                  \n                   Solo 2-9 10-49 50-199 200 or more\n  1. Employers      144 131    48     13           4\n  2. Self-Employed  411 151    22      7           2\n  3. Salaried       296 661   629    332         133\n",
        "> ",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    owners = case_when(",
        "+ ",
        "      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) == 1 | (is.na(company_size) & as.numeric(workplace_size) == 1)) ~ 1,",
        "+ ",
        "      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) == 2 | (is.na(company_size) & as.numeric(workplace_size) == 2)) ~ 2,",
        "+ ",
        "      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) >= 3 | (is.na(company_size) & as.numeric(workplace_size) >= 3)) ~ 3,",
        "+ ",
        "      TRUE ~ NA_real_",
        "+ ",
        "    ),",
        "+ ",
        "    owners = factor(",
        "+ ",
        "      owners,",
        "+ ",
        "      levels = 1:3,",
        "+ ",
        "      labels = c(",
        "+ ",
        "        \"1. Solo Self-Employed\",",
        "+ ",
        "        \"2. Small employers\",",
        "+ ",
        "        \"3. Employers\"",
        "+ ",
        "      )",
        "+ ",
        "    )",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(owners = \"Owners\")",
        "> ",
        "> ",
        "frq(data$owners)",
        "\u001B[31mOwners (x)\u001B[39m\u001B[34m <categorical>\u001B[39m \n\u001B[34m# total N=3048 valid N=935 mean=1.53 sd=0.69\u001B[39m\n\nValue                 |    N | Raw % | Valid % | Cum. %\n-------------------------------------------------------\n1. Solo Self-Employed |  551 | 18.08 |   58.93 |  58.93\n2. Small employers    |  276 |  9.06 |   29.52 |  88.45\n3. Employers          |  108 |  3.54 |   11.55 | 100.00\n<NA>                  | 2113 | 69.32 |    <NA> |   <NA>\n",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    owners2 = case_when(",
        "+ ",
        "      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) == 1 | (is.na(company_size) & as.numeric(workplace_size) == 1)) ~ 1,",
        "+ ",
        "      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) %in% 2:3 | (is.na(company_size) & as.numeric(workplace_size) %in% 2:3)) ~ 2,",
        "+ ",
        "      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) >= 4 | (is.na(company_size) & as.numeric(workplace_size) >= 4)) ~ 3,",
        "+ ",
        "      TRUE ~ NA_real_",
        "+ ",
        "    ),",
        "+ ",
        "    owners2 = factor(",
        "+ ",
        "      owners2,",
        "+ ",
        "      levels = 1:3,",
        "+ ",
        "      labels = c(",
        "+ ",
        "        \"1. Solo Self-Employed\",",
        "+ ",
        "        \"2. Small employers\",",
        "+ ",
        "        \"3. Capitalists\"",
        "+ ",
        "      )",
        "+ ",
        "    )",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(owners2 = \"Owners 2\")",
        "> ",
        "> ",
        "frq(data$owners2)",
        "\u001B[31mOwners 2 (x)\u001B[39m\u001B[34m <categorical>\u001B[39m \n\u001B[34m# total N=3048 valid N=935 mean=1.45 sd=0.57\u001B[39m\n\nValue                 |    N | Raw % | Valid % | Cum. %\n-------------------------------------------------------\n1. Solo Self-Employed |  551 | 18.08 |   58.93 |  58.93\n2. Small employers    |  348 | 11.42 |   37.22 |  96.15\n3. Capitalists        |   36 |  1.18 |    3.85 | 100.00\n<NA>                  | 2113 | 69.32 |    <NA> |   <NA>\n",
        "> ",
        "frq(data$e05)",
        "\u001B[31mx\u001B[39m\u001B[34m <numeric>\u001B[39m \n\u001B[34m# total N=3048 valid N=3048 mean=-2.37 sd=88.97\u001B[39m\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n -999 |   13 |  0.43 |    0.43 |   0.43\n -888 |   14 |  0.46 |    0.46 |   0.89\n    1 |   28 |  0.92 |    0.92 |   1.80\n    2 |   95 |  3.12 |    3.12 |   4.92\n    3 |  215 |  7.05 |    7.05 |  11.98\n    4 |  201 |  6.59 |    6.59 |  18.57\n    5 | 1062 | 34.84 |   34.84 |  53.41\n    6 |  178 |  5.84 |    5.84 |  59.25\n    7 |  440 | 14.44",
        " |   14.44 |  73.69\n    8 |  205 |  6.73 |    6.73 |  80.41\n    9 |  531 | 17.42 |   17.42 |  97.83\n   10 |   66 |  2.17 |    2.17 | 100.00\n <NA> |    0 |  0.00 |    <NA> |   <NA>\n",
        "> ",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    educ = ifelse(e05 %in% c(-999, -888), NA, e05)",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(educ = \"Educational level\")",
        "> ",
        "> ",
        "frq(data$educ)",
        "\u001B[31mEducational level (x)\u001B[39m\u001B[34m <numeric>\u001B[39m \n\u001B[34m# total N=3048 valid N=3021 mean=6.03 sd=2.08\u001B[39m\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n    1 |   28 |  0.92 |    0.93 |   0.93\n    2 |   95 |  3.12 |    3.14 |   4.07\n    3 |  215 |  7.05 |    7.12 |  11.19\n    4 |  201 |  6.59 |    6.65 |  17.84\n    5 | 1062 | 34.84 |   35.15 |  53.00\n    6 |  178 |  5.84 |    5.89 |  58.89\n    7 |  440 | 14.44 |   14.56 |  73.45\n    8 |  205 |  6.73 |    6.79 |  80.24\n  ",
        "  9 |  531 | 17.42 |   17.58 |  97.82\n   10 |   66 |  2.17 |    2.18 | 100.00\n <NA> |   27 |  0.89 |    <NA> |   <NA>\n",
        "> ",
        "# Preparar variables necesarias",
        "> ",
        "> ",
        "## Crear la glosa concatenada",
        "> ",
        "data$glosa_ciuo08 <- paste(data$a02, data$a03, sep = \" \")",
        "> ",
        "> ",
        "## Crear isco a 2 dígitos",
        "> ",
        "data <- data %>%",
        "+ ",
        "  mutate(",
        "+ ",
        "    ciuo08_clio_2d = as.numeric(substr(ciuo08_clio, 1, 2))",
        "+ ",
        "  ) %>%",
        "+ ",
        "  set_variable_labels(ciuo08_clio_2d = \"ISCO-08: 2 digits\")",
        "> ",
        "> ",
        "frq(data$ciuo08_clio_2d)",
        "\u001B[31mISCO-08: 2 digits (x)\u001B[39m\u001B[34m <numeric>\u001B[39m \n\u001B[34m# total N=3048 valid N=3048 mean=54.09 sd=26.33\u001B[39m\n\nValue |   N | Raw % | Valid % | Cum. %\n--------------------------------------\n   -9 |  42 |  1.38 |    1.38 |   1.38\n    1 |  12 |  0.39 |    0.39 |   1.77\n   11 |  20 |  0.66 |    0.66 |   2.43\n   12 |  28 |  0.92 |    0.92 |   3.35\n   13 |  44 |  1.44 |    1.44 |   4.79\n   14 |  11 |  0.36 |    0.36 |   5.15\n   21 |  62 |  2.03 |    2.03 |   7.19\n   22 | 200 |  6.56 |    6.56 |  13.75\n   23 | 14",
        "0 |  4.59 |    4.59 |  18.34\n   24 |  37 |  1.21 |    1.21 |  19.55\n   25 |  12 |  0.39 |    0.39 |  19.95\n   26 | 114 |  3.74 |    3.74 |  23.69\n   31 |  28 |  0.92 |    0.92 |  24.61\n   32 |  27 |  0.89 |    0.89 |  25.49\n   33 | 116 |  3.81 |    3.81 |  29.30\n   34 |  34 |  1.12 |    1.12 |  30.41\n   35 |   6 |  0.20 |    0.20 |  30.61\n   36 |  11 |  0.36 |    0.36 |  30.97\n   41 |   2 |  0.07 |    0.07 |  31.04\n   42 |  13 |  0.43 |    0.43 |  31.46\n   43 |  39 |  1.28 |    1.28 |  32.74\n   44 |   4 |  ",
        "0.13 |    0.13 |  32.87\n   51 | 189 |  6.20 |    6.20 |  39.07\n   52 | 590 | 19.36 |   19.36 |  58.43\n   53 |  57 |  1.87 |    1.87 |  60.30\n   54 | 153 |  5.02 |    5.02 |  65.32\n   55 |   2 |  0.07 |    0.07 |  65.39\n   61 |  28 |  0.92 |    0.92 |  66.31\n   62 |   1 |  0.03 |    0.03 |  66.34\n   63 |   3 |  0.10 |    0.10 |  66.44\n   71 |  60 |  1.97 |    1.97 |  68.41\n   72 | 107 |  3.51 |    3.51 |  71.92\n   73 |  17 |  0.56 |    0.56 |  72.47\n   74 |  16 |  0.52 |    0.52 |  73.00\n   75 |  58 |  1.90 ",
        "|    1.90 |  74.90\n   81 |  25 |  0.82 |    0.82 |  75.72\n   83 | 186 |  6.10 |    6.10 |  81.82\n   91 | 202 |  6.63 |    6.63 |  88.45\n   92 |  91 |  2.99 |    2.99 |  91.44\n   93 | 153 |  5.02 |    5.02 |  96.46\n   94 |  82 |  2.69 |    2.69 |  99.15\n   95 |   1 |  0.03 |    0.03 |  99.18\n   96 |  25 |  0.82 |    0.82 | 100.00\n <NA> |   0 |  0.00 |    <NA> |   <NA>\n",
        "> ",
        "## Armar tabla filtrando a los NA",
        "> ",
        "tabla_ciuo08_999 <- data %>%",
        "+ ",
        "  filter(as.numeric(ciuo08_clio_2d) < 1) %>%",
        "+ ",
        "  select(ciuo08_clio,",
        "+ ",
        "         ciuo08_clio_2d,",
        "+ ",
        "         glosa_ciuo08, ",
        "+ ",
        "         a03,",
        "+ ",
        "         supervisa = a16, ",
        "+ ",
        "         educ = e05, ",
        "+ ",
        "         rama = a25, ",
        "+ ",
        "         a25_esp, ",
        "+ ",
        "         rama_esp = a25_esp_rec)",
        "> ",
        "## Pasar tabla a word",
        "> ",
        "tabla_ft <- flextable(tabla_ciuo08_999)",
        "> ",
        "read_docx() %>%",
        "+ ",
        "  body_add_flextable(value = tabla_ft) %>%",
        "+ ",
        "  print(target = \"output/tabla_ciuo08_999.docx\")",
        "> ",
        "## Revisar NA con API del INE",
        "> ",
        "## Enviar la consulta al servidor",
        "> ",
        "request <-  httr::POST(\"https://rapps.ine.cl:9292/predict\", ",
        "+ ",
        "                       encode = \"json\",",
        "+ ",
        "                       body =  list(text = tabla_ciuo08_999$glosa_ciuo08,",
        "+ ",
        "                                    classification = \"ciuo\",",
        "+ ",
        "                                    digits = 2))",
        "Initiating curl with CURL_SSL_BACKEND: openssl\n\u001BG1;\u001BH1;Error\u001Bh in curl::curl_fetch_memory(url, handle = handle) : \n  Timeout was reached [rapps.ine.cl]: Failed to connect to rapps.ine.cl port 9292 after 10004 ms: Timeout was reached\n\u001Bg",
        "> ",
        "library(curl)",
        "\u001BG3;Using libcurl 8.10.1 with OpenSSL/3.4.0 \n\u001Bg\u001BG3;\nAttaching package: ‘curl’\n\n\u001Bg\u001BG3;The following object is masked from ‘package:readr’:\n\n    parse_date\n\n\u001Bg\u001BG3;The following object is masked from ‘package:httr’:\n\n    handle_reset\n\n\u001Bg",
        "> ",
        "## Revisar NA con API del INE",
        "> ",
        "## Enviar la consulta al servidor",
        "> ",
        "request <-  httr::POST(\"https://rapps.ine.cl:9292/predict\", ",
        "+ ",
        "                       encode = \"json\",",
        "+ ",
        "                       body =  list(text = tabla_ciuo08_999$glosa_ciuo08,",
        "+ ",
        "                                    classification = \"ciuo\",",
        "+ ",
        "                                    digits = 2))",
        "\u001BG1;\u001BH1;Error\u001Bh in curl::curl_fetch_memory(url, handle = handle) : \n  Timeout was reached [rapps.ine.cl]: Failed to connect to rapps.ine.cl port 9292 after 10009 ms: Timeout was reached\n\u001Bg",
        "\u001BG3;Restarting R session...\u001Bg"
    ]
}
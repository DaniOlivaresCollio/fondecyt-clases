{"title":"Procesamiento Data Conclat","markdown":{"headingText":"Procesamiento Data Conclat","containsRefs":false,"markdown":"\n```{r,echo=FALSE,warning=FALSE,message=FALSE}\nrm(list=ls())\noptions(scipen = 999)\n\nlibrary(pacman)\np_load(bookdown,\n       car,\n       ggalluvial,\n       ggplot2,\n       ggrepel,\n       gridExtra,\n       kableExtra,\n       knitr,\n       labelled,\n       lubridate,\n       psych,\n       readr,\n       readxl,\n       shadowtext,\n       sjmisc,\n       sjPlot,\n       sjlabelled,\n       statar,\n       stringr,\n       survey,\n       tidyverse,\n       tinytex,\n       viridis,\n       httr\n       )\n```\n\n## Cargar datos\n\n```{r datos,message=FALSE,warning=FALSE}\nload(\"input/data/datos-conclat.Rdata\")\ndata_raw <- data\n```\n\n## Variables\n\n```{r data,message=FALSE,warning=FALSE}\ndata <- data %>% \n  select(id,\n         rake_wb2,\n         # Relación con los medios de producción\n         a07,\n         a26,\n         a27,\n         # Skills\n         a02,a02_rec,a03,a03_rec,ciuo08,\n         e05,\n         # Autoridad / orgnización\n         a15,\n         a16,\n         a17_01,a17_02,a17_03,a17_04,a17_05,a17_06)# %>% \n  #sjlabelled::set_na(.,na=c(-999,-888,-777))\n```\n\n## Procesamiento\n\n### relation_mop\n\n```{r}\n# Situación empleo\ndata <- data %>%\n  mutate(\n    a07 = factor(\n      as.numeric(a07),\n      levels = 1:9,\n      labels = c(\n        \"1. Patrón(a) o empleador(a)\",\n        \"2. Trabajador(a) por cuenta propia\",\n        \"3. Empleado(a) u obrero(a) del sector público (Gobierno Central o Municipal)\",\n        \"4. Empleado(a) u obrero(a) de empresas públicas\",\n        \"5. Empleado(a) u obrero(a) del sector privado\",\n        \"6. Servicio doméstico puertas adentro\",\n        \"7. Servicio doméstico puertas afuera\",\n        \"8. FF.AA. y del Orden\",\n        \"9. Familiar no remunerado\"\n      )\n    )\n  ) %>%\n  set_variable_labels(a07 = \"Employment situation (a07)\")\n\nfrq(data$a07)\n\ndata <- data %>%\n  mutate(\n    relation_mop = case_when(\n      as_numeric(a07) == 1 ~ 1,\n      as_numeric(a07) == 2 ~ 2,\n      as_numeric(a07) >= 3 ~ 3,\n      TRUE ~ NA_real_\n      ),\n    relation_mop = factor(\n      relation_mop,\n      levels = 1:3,\n      labels = c(\n        \"1. Employers\",\n        \"2. Self-Employed\",\n        \"3. Salaried\"\n      )\n    )\n  ) %>%\n  set_variable_labels(relation_mop = \"Relation with Means of Production\")\n\nfrq(data$relation_mop)\n```\n\n### company_size\n\n```{r}\nfrq(data$a26)\n\ndata <- data %>%\n  mutate(\n    company_size = case_when(\n      a26 %in% c(1) ~ 1,\n      a26 %in% c(2, 3) ~ 2,\n      a26 %in% c(4, 5) ~ 3,\n      a26 %in% c(6, 7) ~ 4,\n      a26 %in% c(8, 9) ~ 5,\n      TRUE ~ NA_real_\n    ),\n    company_size = factor(\n      company_size, \n      levels = 1:5, \n      labels = c(\n        \"Solo\",\n        \"2-9\",\n        \"10-49\",\n        \"50-199\",\n        \"200 or more\"),\n      ordered = TRUE\n    )\n  ) %>%\n  set_variable_labels(company_size = \"Company Size\")\n\nfrq(data$company_size)\n```\n\n### workplace_size\n\n```{r}\nfrq(data$a27)\n\ndata <- data %>%\n  mutate(\n    workplace_size = case_when(\n      a27 %in% c(1) ~ 1,\n      a27 %in% c(2, 3) ~ 2,\n      a27 %in% c(4, 5) ~ 3,\n      a27 %in% c(6, 7) ~ 4,\n      a27 %in% c(8, 9) ~ 5,\n      TRUE ~ NA_real_\n    ),\n    workplace_size = factor(\n      workplace_size, \n      levels = 1:5, \n      labels = c(\n        \"Solo\",\n        \"2-9\",\n        \"10-49\",\n        \"50-199\",\n        \"200 or more\"),\n      ordered = TRUE\n    )\n  ) %>%\n  set_variable_labels(workplace_size = \"Workplace Size\")\n\nfrq(data$workplace_size)\n```\n\n### owners\n\n```{r}\ntable(data$relation_mop,data$company_size)\ntable(data$relation_mop,data$workplace_size)\n\ndata <- data %>%\n  mutate(\n    owners = case_when(\n      as.numeric(relation_mop) %in% 1:2 &\n        (as.numeric(company_size) == 1 | \n         (is.na(company_size) & as.numeric(workplace_size) == 1)) ~ 1,\n      as.numeric(relation_mop) %in% 1:2 &\n        (as.numeric(company_size) == 2 | \n         (is.na(company_size) & as.numeric(workplace_size) == 2)) ~ 2,\n      as.numeric(relation_mop) %in% 1:2 &\n        (as.numeric(company_size) >= 3 |\n         (is.na(company_size) & as.numeric(workplace_size) >= 3)) ~ 3,\n      TRUE ~ NA_real_\n    ),\n    owners = factor(\n      owners,\n      levels = 1:3,\n      labels = c(\n        \"1. Solo Self-Employed\",\n        \"2. Small employers\",\n        \"3. Employers\"\n      )\n    )\n  ) %>%\n  set_variable_labels(owners = \"Owners\")\n\nfrq(data$owners)\n```\n\n### educ\n\n```{r}\nfrq(data$e05)\n\ndata <- data %>%\n  mutate(\n    educ = ifelse(e05 %in% c(-999, -888), NA, e05)\n  ) %>%\n  set_variable_labels(educ = \"Educational level\")\n\nfrq(data$educ)\n```\n\n### isco08_2d\n\n```{r}\n# frq(data$ciuo08)\n\ndata %>%\n  filter(as.numeric(ciuo08) < 1100) %>%\n  select(ciuo08, a03)\n\ndata <- data %>%\n  mutate(\n    isco08_2d = as.numeric(substr(ciuo08, 1, 2)),\n    isco08_2d = ifelse(isco08_2d %in% c(-9, 1), NA, isco08_2d)\n  ) %>%\n  set_variable_labels(isco08_2d = \"ISCO-08: 2 digits\")\n\nfrq(data$isco08_2d)\n```\n\n### skills\n\n- Experts -> ciuo08_2d == 11 a 34 con universitaria completa o más (educ >= 9)\n- Skilled -> ciuo08_2d == 11 a 34 con universitaria incompleta o menos (educ < 9), y\n- Skilled -> ciuo08_2d == 35,41,42,43,44,53, y \n- Skilled -> ciuo08_2d == 51,54,61,62,71,72,73,74,75,81 con media completa o más (educ >= 5).\n- Unskilled -> ciuo08_2d == 51,54,61,62,71,72,73,74,75,81 con media incompleta o menos, y \n- Unskilled -> ciuo08_2d == 52,63,82,83,90+\n\nFalta clasificar: 36, 52, 55 !!!!\n\n```{r}\ndata <- data %>% \n  mutate(\n    skills = case_when(\n      isco08_2d <= 34 & educ >= 9 ~ 1,\n      isco08_2d <= 34 & educ < 9 ~ 2,\n      isco08_2d %in% c(35,41:44,53) ~ 2,\n      isco08_2d %in% c(51,54,61,62,71:75,81) & educ > 5 ~ 2,\n      isco08_2d %in% c(51,54,61,62,71:75,81) & educ <= 5 ~ 3,\n      isco08_2d %in% c(52,63,82,83,91:99) ~ 3\n    ),\n    skills = factor(\n      skills, \n      levels = 1:3,\n      labels = c(\n        \"1. Experts\",\n        \"2. Skilled\",\n        \"3. Unskilled\"\n      )\n    )\n  ) %>%\n  set_variable_labels(skills = \"Skills\")\n\nfrq(data$skills)\n```\n\n### formal_position_auth\n\n```{r}\nfrq(data$a15)\n\ndata <- data %>%\n  mutate(\n    formal_position_auth = case_when(\n      as.numeric(relation_mop) %in% c(1, 2) ~ NA_real_,\n      TRUE ~ as.numeric(a15)\n    ),\n    formal_position_auth = factor(\n      formal_position_auth,\n      levels = 1:4,\n      labels = c(\n        \"1. Senior manager or executive\",\n        \"2. Middle manager (e.g., sector, office or branch head)\",\n        \"3. Supervisor or foreperson\",\n        \"4. Regular employee or worker (no supervisory role)\"\n      )\n    )\n  ) %>%\n  set_variable_labels(formal_position_auth = \"Formal position of authority (a15)\")\n\nfrq(data$formal_position_auth)\n```\n\n### supervision\n\n```{r}\nfrq(data$a16)\n\ndata <- data %>%\n  mutate(\n    supervision = case_when(\n      a16 == 1 ~ 1,\n      a16 %in% c(2, -888, -999) ~ 0,\n      TRUE ~ NA_real_\n    )\n  ) %>%\n  set_variable_labels(supervision = \"Supervises other workers (a16)\")\n\nfrq(data$supervision)\n```\n\n### decisionmaking_influence\n\n```{r}\nfrq(data$a17_01)\nfrq(data$a17_02)\nfrq(data$a17_03)\nfrq(data$a17_04)\nfrq(data$a17_05)\nfrq(data$a17_06)\n\ndata <- data %>%\n  mutate(\n    decisionmaking_influence = if_else(\n      is.na(a17_01),\n      NA_real_,\n      rowSums(across(a17_01:a17_06, ~ case_when(\n        .x == 1 ~ 3,\n        .x == 2 ~ 2,\n        .x == 3 ~ 1,\n        .x %in% c(-888, -999) ~ 1,  \n        TRUE ~ NA_real_\n      )), na.rm = TRUE)\n    ),\n    decisionmaking_influence_mean = if_else(\n      is.na(a17_01),\n      NA_real_,\n      rowMeans(across(a17_01:a17_06, ~ case_when(\n        .x == 1 ~ 3,\n        .x == 2 ~ 2,\n        .x == 3 ~ 1,\n        .x %in% c(-888, -999) ~ 1,\n        TRUE ~ NA_real_\n      )), na.rm = TRUE)\n    )\n  ) %>%\n  set_variable_labels(\n    decisionmaking_influence = \"Decision-making influence (sum, inverted)\",\n    decisionmaking_influence_mean = \"Decision-making influence (mean, inverted)\"\n  )\n\nfrq(data$decisionmaking_influence)\nfrq(data$decisionmaking_influence_mean)\n```\n\n## Descriptivos\n\n```{r}\ntable(data$formal_position_auth, data$decisionmaking_influence)\ntable(data$formal_position_auth, data$decisionmaking_influence_mean)\n```\n\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"01-proce-data-conclat.html"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilización","section-title-copyright":"Derechos de autor","section-title-citation":"Cómo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicación","title-block-modified":"Fecha de modificación","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar todo el código","code-tools-hide-all-code":"Ocultar todo el código","code-tools-view-source":"Ver el código fuente","code-tools-source-code":"Ejecutar el código","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la búsqueda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.3.450","bibliography":["references.bib"],"editor":"visual","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"01-proce-data-conclat.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"editor":"visual","documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}
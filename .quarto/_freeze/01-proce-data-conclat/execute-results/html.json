{
  "hash": "d609c2bc6952c879c8fd54527f6a9e40",
  "result": {
    "markdown": "# Procesamiento Data Conclat\n\n## Preparación\n\n\n::: {.cell}\n\n:::\n\n\n### Cargar datos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(\"input/data/datos-conclat.Rdata\")\ndata_raw <- data\n```\n:::\n\n\n### Selección de Variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data_raw %>% \n  select(id,\n         rake_wb2,\n         # Relación con los medios de producción\n         a07,\n         a25, a25_esp, a25_esp_rec,\n         a26,\n         a27,\n         # Skills\n         a02,a02_rec,a03,a03_rec,\n         ciuo08_clio = ciuo08,\n         e05,\n         # Autoridad / orgnización\n         a15,\n         a16,\n         a17_01,a17_02,a17_03,a17_04,a17_05,a17_06,\n         # formalidad\n         a06,                                        # boleta\n         a10,\n         a18\n         )# %>% \n  #sjlabelled::set_na(.,na=c(-999,-888,-777))\n```\n:::\n\n\n## Procesamiento\n\n### relation_mop\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Situación empleo\ndata <- data %>%\n  mutate(\n    a07 = factor(\n      as.numeric(a07),\n      levels = 1:9,\n      labels = c(\n        \"1. Patrón(a) o empleador(a)\",\n        \"2. Trabajador(a) por cuenta propia\",\n        \"3. Empleado(a) u obrero(a) del sector público (Gobierno Central o Municipal)\",\n        \"4. Empleado(a) u obrero(a) de empresas públicas\",\n        \"5. Empleado(a) u obrero(a) del sector privado\",\n        \"6. Servicio doméstico puertas adentro\",\n        \"7. Servicio doméstico puertas afuera\",\n        \"8. FF.AA. y del Orden\",\n        \"9. Familiar no remunerado\"\n      )\n    )\n  ) %>%\n  set_variable_labels(a07 = \"Employment situation (a07)\")\n\nfrq(data$a07)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEmployment situation (a07) (x) <categorical> \n# total N=3048 valid N=3048 mean=3.79 sd=1.67\n\nValue                                                                        |    N | Raw % | Valid % | Cum. %\n--------------------------------------------------------------------------------------------------------------\n1. Patrón(a) o empleador(a)                                                  |  345 | 11.32 |   11.32 |  11.32\n2. Trabajador(a) por cuenta propia                                           |  598 | 19.62 |   19.62 |  30.94\n3. Empleado(a) u obrero(a) del sector público (Gobierno Central o Municipal) |  251 |  8.23 |    8.23 |  39.17\n4. Empleado(a) u obrero(a) de empresas públicas                              |  337 | 11.06 |   11.06 |  50.23\n5. Empleado(a) u obrero(a) del sector privado                                | 1370 | 44.95 |   44.95 |  95.18\n6. Servicio doméstico puertas adentro                                        |   21 |  0.69 |    0.69 |  95.87\n7. Servicio doméstico puertas afuera                                         |  101 |  3.31 |    3.31 |  99.18\n8. FF.AA. y del Orden                                                        |   13 |  0.43 |    0.43 |  99.61\n9. Familiar no remunerado                                                    |   12 |  0.39 |    0.39 | 100.00\n<NA>                                                                         |    0 |  0.00 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    relation_mop = case_when(\n      as_numeric(a07) == 1 ~ 1,\n      as_numeric(a07) == 2 ~ 2,\n      as_numeric(a07) >= 3 ~ 3,\n      TRUE ~ NA_real_\n      ),\n    relation_mop = factor(\n      relation_mop,\n      levels = 1:3,\n      labels = c(\n        \"1. Employers\",\n        \"2. Self-Employed\",\n        \"3. Salaried\"\n      )\n    )\n  ) %>%\n  set_variable_labels(relation_mop = \"Relation with Means of Production\")\n\nfrq(data$relation_mop)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRelation with Means of Production (x) <categorical> \n# total N=3048 valid N=3048 mean=2.58 sd=0.69\n\nValue            |    N | Raw % | Valid % | Cum. %\n--------------------------------------------------\n1. Employers     |  345 | 11.32 |   11.32 |  11.32\n2. Self-Employed |  598 | 19.62 |   19.62 |  30.94\n3. Salaried      | 2105 | 69.06 |   69.06 | 100.00\n<NA>             |    0 |  0.00 |    <NA> |   <NA>\n```\n:::\n:::\n\n\n### company_size\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfrq(data$a26)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=3048 mean=-73.62 sd=251.41\n\nValue |   N | Raw % | Valid % | Cum. %\n--------------------------------------\n -999 |   8 |  0.26 |    0.26 |   0.26\n -888 | 255 |  8.37 |    8.37 |   8.63\n    1 | 783 | 25.69 |   25.69 |  34.32\n    2 | 486 | 15.94 |   15.94 |  50.26\n    3 | 277 |  9.09 |    9.09 |  59.35\n    4 | 316 | 10.37 |   10.37 |  69.72\n    5 | 291 |  9.55 |    9.55 |  79.27\n    6 | 183 |  6.00 |    6.00 |  85.27\n    7 | 150 |  4.92 |    4.92 |  90.19\n    8 | 113 |  3.71 |    3.71 |  93.90\n    9 | 186 |  6.10 |    6.10 | 100.00\n <NA> |   0 |  0.00 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    company_size = case_when(\n      a26 %in% c(1) ~ 1,\n      a26 %in% c(2, 3) ~ 2,\n      a26 %in% c(4, 5) ~ 3,\n      a26 %in% c(6, 7) ~ 4,\n      a26 %in% c(8, 9) ~ 5,\n      TRUE ~ NA_real_\n    ),\n    company_size = factor(\n      company_size, \n      levels = 1:5, \n      labels = c(\n        \"Solo\",\n        \"2-9\",\n        \"10-49\",\n        \"50-199\",\n        \"200 or more\"),\n      ordered = TRUE\n    )\n  ) %>%\n  set_variable_labels(company_size = \"Company Size\")\n\nfrq(data$company_size)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCompany Size (x) <ordinal> \n# total N=3048 valid N=2785 mean=2.50 sd=1.30\n\nValue       |   N | Raw % | Valid % | Cum. %\n--------------------------------------------\nSolo        | 783 | 25.69 |   28.11 |  28.11\n2-9         | 763 | 25.03 |   27.40 |  55.51\n10-49       | 607 | 19.91 |   21.80 |  77.31\n50-199      | 333 | 10.93 |   11.96 |  89.26\n200 or more | 299 |  9.81 |   10.74 | 100.00\n<NA>        | 263 |  8.63 |    <NA> |   <NA>\n```\n:::\n:::\n\n\n### workplace_size\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfrq(data$a27)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=3048 mean=-15.76 sd=129.92\n\nValue |   N | Raw % | Valid % | Cum. %\n--------------------------------------\n -999 |   8 |  0.26 |    0.26 |   0.26\n -888 |  56 |  1.84 |    1.84 |   2.10\n    1 | 851 | 27.92 |   27.92 |  30.02\n    2 | 590 | 19.36 |   19.36 |  49.38\n    3 | 353 | 11.58 |   11.58 |  60.96\n    4 | 358 | 11.75 |   11.75 |  72.70\n    5 | 341 | 11.19 |   11.19 |  83.89\n    6 | 198 |  6.50 |    6.50 |  90.39\n    7 | 154 |  5.05 |    5.05 |  95.44\n    8 |  71 |  2.33 |    2.33 |  97.77\n    9 |  68 |  2.23 |    2.23 | 100.00\n <NA> |   0 |  0.00 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    workplace_size = case_when(\n      a27 %in% c(1) ~ 1,\n      a27 %in% c(2, 3) ~ 2,\n      a27 %in% c(4, 5) ~ 3,\n      a27 %in% c(6, 7) ~ 4,\n      a27 %in% c(8, 9) ~ 5,\n      TRUE ~ NA_real_\n    ),\n    workplace_size = factor(\n      workplace_size, \n      levels = 1:5, \n      labels = c(\n        \"Solo\",\n        \"2-9\",\n        \"10-49\",\n        \"50-199\",\n        \"200 or more\"),\n      ordered = TRUE\n    )\n  ) %>%\n  set_variable_labels(workplace_size = \"Workplace Size\")\n\nfrq(data$workplace_size)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWorkplace Size (x) <ordinal> \n# total N=3048 valid N=2984 mean=2.32 sd=1.14\n\nValue       |   N | Raw % | Valid % | Cum. %\n--------------------------------------------\nSolo        | 851 | 27.92 |   28.52 |  28.52\n2-9         | 943 | 30.94 |   31.60 |  60.12\n10-49       | 699 | 22.93 |   23.42 |  83.55\n50-199      | 352 | 11.55 |   11.80 |  95.34\n200 or more | 139 |  4.56 |    4.66 | 100.00\n<NA>        |  64 |  2.10 |    <NA> |   <NA>\n```\n:::\n:::\n\n\n### owners\n\n- 1 == employers o self employed sin empleados\n- 2 == employers o self employed con 2-9 empleados\n- 3 == employers o self employed com >= 10 empleados\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(data$relation_mop,data$company_size)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  \n                   Solo 2-9 10-49 50-199 200 or more\n  1. Employers      141 128    47     12          11\n  2. Self-Employed  402 140    20      4           9\n  3. Salaried       240 495   540    317         279\n```\n:::\n\n```{.r .cell-code}\ntable(data$relation_mop,data$workplace_size)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  \n                   Solo 2-9 10-49 50-199 200 or more\n  1. Employers      144 131    48     13           4\n  2. Self-Employed  411 151    22      7           2\n  3. Salaried       296 661   629    332         133\n```\n:::\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    owners = case_when(\n      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) == 1 | (is.na(company_size) & as.numeric(workplace_size) == 1)) ~ 1,\n      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) == 2 | (is.na(company_size) & as.numeric(workplace_size) == 2)) ~ 2,\n      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) >= 3 | (is.na(company_size) & as.numeric(workplace_size) >= 3)) ~ 3,\n      TRUE ~ NA_real_\n    ),\n    owners = factor(\n      owners,\n      levels = 1:3,\n      labels = c(\n        \"1. Solo Self-Employed\",\n        \"2. Small employers\",\n        \"3. Employers\"\n      )\n    )\n  ) %>%\n  set_variable_labels(owners = \"Owners\")\n\nfrq(data$owners)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOwners (x) <categorical> \n# total N=3048 valid N=935 mean=1.53 sd=0.69\n\nValue                 |    N | Raw % | Valid % | Cum. %\n-------------------------------------------------------\n1. Solo Self-Employed |  551 | 18.08 |   58.93 |  58.93\n2. Small employers    |  276 |  9.06 |   29.52 |  88.45\n3. Employers          |  108 |  3.54 |   11.55 | 100.00\n<NA>                  | 2113 | 69.32 |    <NA> |   <NA>\n```\n:::\n:::\n\n\n### owners2\n\n- 1 == employers o self employed sin empleados\n- 2 == employers o self employed con 2-49 empleados\n- 3 == employers o self employed com >= 50 empleados\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    owners2 = case_when(\n      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) == 1 | (is.na(company_size) & as.numeric(workplace_size) == 1)) ~ 1,\n      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) %in% 2:3 | (is.na(company_size) & as.numeric(workplace_size) %in% 2:3)) ~ 2,\n      as.numeric(relation_mop) %in% 1:2 & (as.numeric(company_size) >= 4 | (is.na(company_size) & as.numeric(workplace_size) >= 4)) ~ 3,\n      TRUE ~ NA_real_\n    ),\n    owners2 = factor(\n      owners2,\n      levels = 1:3,\n      labels = c(\n        \"1. Solo Self-Employed\",\n        \"2. Small employers\",\n        \"3. Employers\"\n      )\n    )\n  ) %>%\n  set_variable_labels(owners2 = \"Owners 2\")\n\nfrq(data$owners2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOwners 2 (x) <categorical> \n# total N=3048 valid N=935 mean=1.45 sd=0.57\n\nValue                 |    N | Raw % | Valid % | Cum. %\n-------------------------------------------------------\n1. Solo Self-Employed |  551 | 18.08 |   58.93 |  58.93\n2. Small employers    |  348 | 11.42 |   37.22 |  96.15\n3. Employers          |   36 |  1.18 |    3.85 | 100.00\n<NA>                  | 2113 | 69.32 |    <NA> |   <NA>\n```\n:::\n:::\n\n\n### educ\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfrq(data$e05)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=3048 mean=-2.37 sd=88.97\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n -999 |   13 |  0.43 |    0.43 |   0.43\n -888 |   14 |  0.46 |    0.46 |   0.89\n    1 |   28 |  0.92 |    0.92 |   1.80\n    2 |   95 |  3.12 |    3.12 |   4.92\n    3 |  215 |  7.05 |    7.05 |  11.98\n    4 |  201 |  6.59 |    6.59 |  18.57\n    5 | 1062 | 34.84 |   34.84 |  53.41\n    6 |  178 |  5.84 |    5.84 |  59.25\n    7 |  440 | 14.44 |   14.44 |  73.69\n    8 |  205 |  6.73 |    6.73 |  80.41\n    9 |  531 | 17.42 |   17.42 |  97.83\n   10 |   66 |  2.17 |    2.17 | 100.00\n <NA> |    0 |  0.00 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    educ = ifelse(e05 %in% c(-999, -888), NA, e05)\n  ) %>%\n  set_variable_labels(educ = \"Educational level\")\n\nfrq(data$educ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEducational level (x) <numeric> \n# total N=3048 valid N=3021 mean=6.03 sd=2.08\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n    1 |   28 |  0.92 |    0.93 |   0.93\n    2 |   95 |  3.12 |    3.14 |   4.07\n    3 |  215 |  7.05 |    7.12 |  11.19\n    4 |  201 |  6.59 |    6.65 |  17.84\n    5 | 1062 | 34.84 |   35.15 |  53.00\n    6 |  178 |  5.84 |    5.89 |  58.89\n    7 |  440 | 14.44 |   14.56 |  73.45\n    8 |  205 |  6.73 |    6.79 |  80.24\n    9 |  531 | 17.42 |   17.58 |  97.82\n   10 |   66 |  2.17 |    2.18 | 100.00\n <NA> |   27 |  0.89 |    <NA> |   <NA>\n```\n:::\n:::\n\n\n### ciuo08_clio_2d\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Preparar variables necesarias\n\n## Crear la glosa concatenada\ndata$glosa_ciuo08 <- paste(data$a02, data$a03, sep = \" \")\n\n## Crear isco a 2 dígitos\ndata <- data %>%\n  mutate(\n    ciuo08_clio_2d = as.numeric(substr(ciuo08_clio, 1, 2))\n  ) %>%\n  set_variable_labels(ciuo08_clio_2d = \"ISCO-08: 2 digits\")\n\nfrq(data$ciuo08_clio_2d)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nISCO-08: 2 digits (x) <numeric> \n# total N=3048 valid N=3048 mean=54.09 sd=26.33\n\nValue |   N | Raw % | Valid % | Cum. %\n--------------------------------------\n   -9 |  42 |  1.38 |    1.38 |   1.38\n    1 |  12 |  0.39 |    0.39 |   1.77\n   11 |  20 |  0.66 |    0.66 |   2.43\n   12 |  28 |  0.92 |    0.92 |   3.35\n   13 |  44 |  1.44 |    1.44 |   4.79\n   14 |  11 |  0.36 |    0.36 |   5.15\n   21 |  62 |  2.03 |    2.03 |   7.19\n   22 | 200 |  6.56 |    6.56 |  13.75\n   23 | 140 |  4.59 |    4.59 |  18.34\n   24 |  37 |  1.21 |    1.21 |  19.55\n   25 |  12 |  0.39 |    0.39 |  19.95\n   26 | 114 |  3.74 |    3.74 |  23.69\n   31 |  28 |  0.92 |    0.92 |  24.61\n   32 |  27 |  0.89 |    0.89 |  25.49\n   33 | 116 |  3.81 |    3.81 |  29.30\n   34 |  34 |  1.12 |    1.12 |  30.41\n   35 |   6 |  0.20 |    0.20 |  30.61\n   36 |  11 |  0.36 |    0.36 |  30.97\n   41 |   2 |  0.07 |    0.07 |  31.04\n   42 |  13 |  0.43 |    0.43 |  31.46\n   43 |  39 |  1.28 |    1.28 |  32.74\n   44 |   4 |  0.13 |    0.13 |  32.87\n   51 | 189 |  6.20 |    6.20 |  39.07\n   52 | 590 | 19.36 |   19.36 |  58.43\n   53 |  57 |  1.87 |    1.87 |  60.30\n   54 | 153 |  5.02 |    5.02 |  65.32\n   55 |   2 |  0.07 |    0.07 |  65.39\n   61 |  28 |  0.92 |    0.92 |  66.31\n   62 |   1 |  0.03 |    0.03 |  66.34\n   63 |   3 |  0.10 |    0.10 |  66.44\n   71 |  60 |  1.97 |    1.97 |  68.41\n   72 | 107 |  3.51 |    3.51 |  71.92\n   73 |  17 |  0.56 |    0.56 |  72.47\n   74 |  16 |  0.52 |    0.52 |  73.00\n   75 |  58 |  1.90 |    1.90 |  74.90\n   81 |  25 |  0.82 |    0.82 |  75.72\n   83 | 186 |  6.10 |    6.10 |  81.82\n   91 | 202 |  6.63 |    6.63 |  88.45\n   92 |  91 |  2.99 |    2.99 |  91.44\n   93 | 153 |  5.02 |    5.02 |  96.46\n   94 |  82 |  2.69 |    2.69 |  99.15\n   95 |   1 |  0.03 |    0.03 |  99.18\n   96 |  25 |  0.82 |    0.82 | 100.00\n <NA> |   0 |  0.00 |    <NA> |   <NA>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Revisar los NA\n\n## Armar tabla filtrando a los NA\ntabla_ciuo08_999 <- data %>%\n  filter(as.numeric(ciuo08_clio_2d) < 1) %>%\n  select(ciuo08_clio,\n         ciuo08_clio_2d,\n         glosa_ciuo08, \n         a03,\n         supervisa = a16, \n         educ = e05, \n         rama = a25, \n         a25_esp, \n         rama_esp = a25_esp_rec)\n\n## Pasar tabla a word\ntabla_ft <- flextable(tabla_ciuo08_999)\nread_docx() %>%\n  body_add_flextable(value = tabla_ft) %>%\n  print(target = \"output/tabla_ciuo08_999.docx\")\n\n## Revisar NA con API del INE\n## Enviar la consulta al servidor\nrequest <-  httr::POST(\"https://rapps.ine.cl:9292/predict\", \n                       encode = \"json\",\n                       body =  list(text = tabla_ciuo08_999$glosa_ciuo08,\n                                    classification = \"ciuo\",\n                                    digits = 2))\n\n## Extraer el contenido\nciuo08_ine_999 <- httr::content(request)\n\n## Agregar como nueva columna a la base original\ntabla_ciuo08_999$ciuo08_ine_999 <- unlist(ciuo08_ine_999$cod_final)\n\n## Armar tabla filtrando a los NA con ciuo08 ine 999\ntabla_ciuo08_999_ine <- tabla_ciuo08_999 %>%\n  select(ciuo08_clio,\n         ciuo08_clio_2d,\n         ciuo08_ine_999,\n         glosa_ciuo08, \n         a03,\n         supervisa, \n         educ, \n         rama, \n         rama_esp)\n\n## Pasar tabla a word\ntabla_ft <- flextable(tabla_ciuo08_999_ine)\nread_docx() %>%\n  body_add_flextable(value = tabla_ft) %>%\n  print(target = \"output/tabla_ciuo08_999_ine.docx\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Recuperar algunos NA\n\n## Recodificar ciuo08 de NA recuperados\ndata <- data %>%\n  mutate(\n    ciuo08_clio = case_when(\n      ciuo08_clio == \"-999\" & a03 == \"tejer\" ~ \"7318\", # Artesanos de los tejidos, el cuero y materiales similares\n      ciuo08_clio == \"-999\" & a03 == \"mantención\" ~ \"3121\",\n      ciuo08_clio == \"-999\" & a03 == \"aseo limpieza\" ~ \"9111\",\n      ciuo08_clio == \"-999\" & a03 == \"casa\" ~ \"9111\",\n      ciuo08_clio == \"-999\" & a03 == \"supervisar trabajos\" ~ \"3121\",\n      ciuo08_clio == \"-999\" & a03 == \"maquina pesada\" ~ \"8332\",\n      ciuo08_clio == \"-999\" & a03 == \"no responde\" ~ \"9111\",\n      ciuo08_clio == \"-999\" & a03 == \"Independiente\" ~ \"5212\",\n      ciuo08_clio == \"-999\" & a03 == \"estaba en la casa por permiso administrativo\" ~ \"9331\",\n      ciuo08_clio == \"-999\" & a03 == \"no trabja por ahoravendedor\" ~ \"5211\",\n      ciuo08_clio == \"-999\" & a03 == \"organizar y ordenar ropa\" ~ \"5242\",\n      ciuo08_clio == \"-999\" & a03 == \"ordenar y organizar ropa\" ~ \"5242\",\n      ciuo08_clio == \"-999\" & a03 == \"stripper\" ~ \"5249\",\n      TRUE ~ ciuo08_clio\n    )\n  )\n\n## Volver a crear ciuo08 con 2 dígitos y pasar -999 a NA\ndata <- data %>%\n  mutate(\n    ciuo08_clio_2d = as.numeric(substr(ciuo08_clio, 1, 2)),\n    ciuo08_clio_2d = ifelse(ciuo08_clio_2d==-9, NA,ciuo08_clio_2d)\n  ) %>%\n  set_variable_labels(ciuo08_clio_2d = \"ISCO-08: 2 digits\")\n\nfrq(data$ciuo08_clio_2d)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nISCO-08: 2 digits (x) <numeric> \n# total N=3048 valid N=3019 mean=55.01 sd=25.42\n\nValue |   N | Raw % | Valid % | Cum. %\n--------------------------------------\n    1 |  12 |  0.39 |    0.40 |   0.40\n   11 |  20 |  0.66 |    0.66 |   1.06\n   12 |  28 |  0.92 |    0.93 |   1.99\n   13 |  44 |  1.44 |    1.46 |   3.44\n   14 |  11 |  0.36 |    0.36 |   3.81\n   21 |  62 |  2.03 |    2.05 |   5.86\n   22 | 200 |  6.56 |    6.62 |  12.49\n   23 | 140 |  4.59 |    4.64 |  17.12\n   24 |  37 |  1.21 |    1.23 |  18.35\n   25 |  12 |  0.39 |    0.40 |  18.75\n   26 | 114 |  3.74 |    3.78 |  22.52\n   31 |  30 |  0.98 |    0.99 |  23.52\n   32 |  27 |  0.89 |    0.89 |  24.41\n   33 | 116 |  3.81 |    3.84 |  28.25\n   34 |  34 |  1.12 |    1.13 |  29.38\n   35 |   6 |  0.20 |    0.20 |  29.58\n   36 |  11 |  0.36 |    0.36 |  29.94\n   41 |   2 |  0.07 |    0.07 |  30.01\n   42 |  13 |  0.43 |    0.43 |  30.44\n   43 |  39 |  1.28 |    1.29 |  31.73\n   44 |   4 |  0.13 |    0.13 |  31.86\n   51 | 189 |  6.20 |    6.26 |  38.13\n   52 | 595 | 19.52 |   19.71 |  57.83\n   53 |  57 |  1.87 |    1.89 |  59.72\n   54 | 153 |  5.02 |    5.07 |  64.79\n   55 |   2 |  0.07 |    0.07 |  64.86\n   61 |  28 |  0.92 |    0.93 |  65.78\n   62 |   1 |  0.03 |    0.03 |  65.82\n   63 |   3 |  0.10 |    0.10 |  65.92\n   71 |  60 |  1.97 |    1.99 |  67.90\n   72 | 107 |  3.51 |    3.54 |  71.45\n   73 |  18 |  0.59 |    0.60 |  72.04\n   74 |  16 |  0.52 |    0.53 |  72.57\n   75 |  58 |  1.90 |    1.92 |  74.49\n   81 |  25 |  0.82 |    0.83 |  75.32\n   83 | 187 |  6.14 |    6.19 |  81.52\n   91 | 205 |  6.73 |    6.79 |  88.31\n   92 |  91 |  2.99 |    3.01 |  91.32\n   93 | 154 |  5.05 |    5.10 |  96.42\n   94 |  82 |  2.69 |    2.72 |  99.14\n   95 |   1 |  0.03 |    0.03 |  99.17\n   96 |  25 |  0.82 |    0.83 | 100.00\n <NA> |  29 |  0.95 |    <NA> |   <NA>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Chequeo códigos no existentes ciuo clio = 36, 55\n\n## Armar tabla\ntabla_ciuo08_36_55 <- data %>%\n  filter(as.numeric(ciuo08_clio_2d) %in% c(36, 55)) %>%\n  select(ciuo08_clio,\n         ciuo08_clio_2d,\n         glosa_ciuo08,\n         id,\n         supervisa = a16, \n         educ = e05, \n         rama = a25, \n         rama_esp = a25_esp_rec)\n\n## Pasar tabla a word\ntabla_ft <- flextable(tabla_ciuo08_36_55)\nread_docx() %>%\n  body_add_flextable(value = tabla_ft) %>%\n  print(target = \"output/tabla_ciuo08_36_55.docx\")\n\n## Revisar 36 y 55 con API del INE\n## Enviar la consulta al servidor\nrequest <-  httr::POST(\"https://rapps.ine.cl:9292/predict\", \n                       encode = \"json\",\n                       body =  list(text = tabla_ciuo08_36_55$glosa_ciuo08,\n                                    classification = \"ciuo\",\n                                    digits = 2))\n\n## Extraer el contenido\nciuo08_ine_36_55 <- httr::content(request)\n\n## Agregar como nueva columna a la base original\ntabla_ciuo08_36_55$ciuo08_ine_36_55 <- unlist(ciuo08_ine_36_55$cod_final)\n\n## Armar tabla filtrando a los NA con ciuo08 ine 999\ntabla_ciuo08_36_55_ine <- tabla_ciuo08_36_55 %>%\n  select(ciuo08_clio,\n         ciuo08_clio_2d,\n         ciuo08_ine_36_55,\n         glosa_ciuo08, \n         id,\n         supervisa, \n         educ, \n         rama, \n         rama_esp)\n\n## Pasar tabla a word\ntabla_ft <- flextable(tabla_ciuo08_36_55_ine)\nread_docx() %>%\n  body_add_flextable(value = tabla_ft) %>%\n  print(target = \"output/tabla_ciuo08_36_55_ine.docx\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Recuperar algunos códigos no existentes\n\n## Recodificar ciuo08 de 36 55 recuperados\ndata <- data %>%\n  mutate(\n    ciuo08_clio = case_when(\n      ciuo08_clio == \"5522\" & id == \"var_223\" ~ \"3343\",\n      ciuo08_clio == \"5521\" & id == \"var_2536\" ~ \"7322\",\n      TRUE ~ ciuo08_clio\n    )\n  )\n\n## Volver a crear ciuo08 con 2 dígitos\ndata <- data %>%\n  mutate(\n    ciuo08_clio_2d = as.numeric(substr(ciuo08_clio, 1, 2)),\n    ciuo08_clio_2d = ifelse(ciuo08_clio_2d==-9, NA,ciuo08_clio_2d)\n  ) %>%\n  set_variable_labels(ciuo08_clio_2d = \"ISCO-08: 2 digits\")\n\nfrq(data$ciuo08_clio_2d)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nISCO-08: 2 digits (x) <numeric> \n# total N=3048 valid N=3019 mean=55.01 sd=25.42\n\nValue |   N | Raw % | Valid % | Cum. %\n--------------------------------------\n    1 |  12 |  0.39 |    0.40 |   0.40\n   11 |  20 |  0.66 |    0.66 |   1.06\n   12 |  28 |  0.92 |    0.93 |   1.99\n   13 |  44 |  1.44 |    1.46 |   3.44\n   14 |  11 |  0.36 |    0.36 |   3.81\n   21 |  62 |  2.03 |    2.05 |   5.86\n   22 | 200 |  6.56 |    6.62 |  12.49\n   23 | 140 |  4.59 |    4.64 |  17.12\n   24 |  37 |  1.21 |    1.23 |  18.35\n   25 |  12 |  0.39 |    0.40 |  18.75\n   26 | 114 |  3.74 |    3.78 |  22.52\n   31 |  30 |  0.98 |    0.99 |  23.52\n   32 |  27 |  0.89 |    0.89 |  24.41\n   33 | 117 |  3.84 |    3.88 |  28.29\n   34 |  34 |  1.12 |    1.13 |  29.41\n   35 |   6 |  0.20 |    0.20 |  29.61\n   36 |  11 |  0.36 |    0.36 |  29.98\n   41 |   2 |  0.07 |    0.07 |  30.04\n   42 |  13 |  0.43 |    0.43 |  30.47\n   43 |  39 |  1.28 |    1.29 |  31.77\n   44 |   4 |  0.13 |    0.13 |  31.90\n   51 | 189 |  6.20 |    6.26 |  38.16\n   52 | 595 | 19.52 |   19.71 |  57.87\n   53 |  57 |  1.87 |    1.89 |  59.75\n   54 | 153 |  5.02 |    5.07 |  64.82\n   61 |  28 |  0.92 |    0.93 |  65.75\n   62 |   1 |  0.03 |    0.03 |  65.78\n   63 |   3 |  0.10 |    0.10 |  65.88\n   71 |  60 |  1.97 |    1.99 |  67.87\n   72 | 107 |  3.51 |    3.54 |  71.41\n   73 |  19 |  0.62 |    0.63 |  72.04\n   74 |  16 |  0.52 |    0.53 |  72.57\n   75 |  58 |  1.90 |    1.92 |  74.49\n   81 |  25 |  0.82 |    0.83 |  75.32\n   83 | 187 |  6.14 |    6.19 |  81.52\n   91 | 205 |  6.73 |    6.79 |  88.31\n   92 |  91 |  2.99 |    3.01 |  91.32\n   93 | 154 |  5.05 |    5.10 |  96.42\n   94 |  82 |  2.69 |    2.72 |  99.14\n   95 |   1 |  0.03 |    0.03 |  99.17\n   96 |  25 |  0.82 |    0.83 | 100.00\n <NA> |  29 |  0.95 |    <NA> |   <NA>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Chequeo COMPLETO de códigos ciuo08 con api INE\n\n## Enviar la consulta al servidor\nrequest <-  httr::POST(\"https://rapps.ine.cl:9292/predict\", \n                       encode = \"json\",\n                       body =  list(text = data$glosa_ciuo08,\n                                    classification = \"ciuo\",\n                                    digits = 2))\n\n## Extraer el contenido\nciuo08_ine <- httr::content(request)\n\n## Agregar como nueva columna a la base original\ndata$ciuo08_ine <- unlist(ciuo08_ine$cod_final)\n\n## Volver NA en ciuo08_ine los NA de ciuo08_clio_2d\ndata <- data %>%\n  mutate(\n    ciuo08_ine = ifelse(is.na(ciuo08_clio_2d), NA, ciuo08_ine)\n  )\n\n## Buscar los códigos diferentes\ndiferente_ciuo <- data %>%\n  filter(ciuo08_ine != ciuo08_clio_2d | (is.na(ciuo08_ine) != is.na(ciuo08_clio_2d))) %>%\n  select(glosa_ciuo08, ciuo08_clio_2d, ciuo08_ine)\n\ndiferente_ciuo\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 845 × 3\n   glosa_ciuo08                                        ciuo08_clio_2d ciuo08_ine\n   <chr>                                                        <dbl> <chr>     \n 1 isabel antonia castillo venegas vendedora de flores             75 52        \n 2 trabajar manipular alimentos                                    94 51        \n 3 Funcionario Público Remuneración                                43 33        \n 4 adminustrativa de salud atender clientes                        33 22        \n 5 dueña de casa aseo                                              51 91        \n 6 empresa paisajismo areas verdes cuidamos el medio …             21 61        \n 7 tens cuidados adulto mayores                                    22 32        \n 8 minera cocina                                                   21 81        \n 9 Atención público Cajera, atención. Trabajo con niñ…             52 42        \n10 repartidor de encomienda dejar encomiendas en resp…             96 83        \n# ℹ 835 more rows\n```\n:::\n:::\n\n\n### skills\n\n- Experts -> ciuo08_2d == 11 a 34 con universitaria completa o más (educ >= 9) ---> experts\n- Skilled -> ciuo08_2d == 11 a 34 con universitaria incompleta o menos (educ < 9), y\n- Skilled -> ciuo08_2d == 35,36,41:44,53, y \n- Skilled -> ciuo08_2d == 51,54,61,62,71:75,81 con media completa o más (educ >= 5).\n- Unskilled -> ciuo08_2d == 51,54,61,62,71:75,81 con media incompleta o menos, y \n- Unskilled -> ciuo08_2d == 52,63,82,83,90+\n\n- 61 62 71:75 --> skilled\n- 51,54,81 --> unskilled\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data %>% \n  mutate(\n    skills = case_when(\n      ciuo08_ine <= 34 & educ >= 9 ~ 1,\n      ciuo08_ine <= 34 & is.na(educ)~ 1,  \n      \n      ciuo08_ine <= 34 & educ < 9 ~ 2,\n      ciuo08_ine %in% c(35, 36, 41:44, 53) ~ 2,\n      ciuo08_ine %in% c(51, 54, 61, 62, 71:75, 81) & educ >= 5 ~ 2,\n      ciuo08_ine %in% c(61, 62, 71:75) & is.na(educ) ~ 2,\n      \n      ciuo08_ine %in% c(51, 54, 61, 62, 71:75, 81) & educ <= 4 ~ 3,\n      ciuo08_ine %in% c(52, 63, 82, 83, 91:99) ~ 3,\n      ciuo08_ine %in% c(51, 54, 81) & is.na(educ) ~ 3     \n    ),\n    skills = factor(\n      skills, \n      levels = 1:3,\n      labels = c(\n        \"1. Experts\",\n        \"2. Skilled\",\n        \"3. Unskilled\"\n      )\n    )\n  ) %>%\n  set_variable_labels(skills = \"Skills\")\n\n\nfrq(data$skills)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSkills (x) <categorical> \n# total N=3048 valid N=3019 mean=2.29 sd=0.72\n\nValue        |    N | Raw % | Valid % | Cum. %\n----------------------------------------------\n1. Experts   |  469 | 15.39 |   15.53 |  15.53\n2. Skilled   | 1198 | 39.30 |   39.68 |  55.22\n3. Unskilled | 1352 | 44.36 |   44.78 | 100.00\n<NA>         |   29 |  0.95 |    <NA> |   <NA>\n```\n:::\n:::\n\n\n### formal_position_auth\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfrq(data$a15)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=2107 mean=3.76 sd=0.63\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n    1 |   41 |  1.35 |    1.95 |   1.95\n    2 |  102 |  3.35 |    4.84 |   6.79\n    3 |  188 |  6.17 |    8.92 |  15.71\n    4 | 1776 | 58.27 |   84.29 | 100.00\n <NA> |  941 | 30.87 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    formal_position_auth = case_when(\n      as.numeric(relation_mop) %in% c(1, 2) ~ NA_real_,\n      TRUE ~ as.numeric(a15)\n    ),\n    formal_position_auth = factor(\n      formal_position_auth,\n      levels = 1:4,\n      labels = c(\n        \"1. Senior manager or executive\",\n        \"2. Middle manager (e.g., sector, office or branch head)\",\n        \"3. Supervisor or foreperson\",\n        \"4. Regular employee or worker (no supervisory role)\"\n      )\n    )\n  ) %>%\n  set_variable_labels(formal_position_auth = \"Formal position of authority (a15)\")\n\nfrq(data$formal_position_auth)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nFormal position of authority (a15) (x) <categorical> \n# total N=3048 valid N=2105 mean=3.76 sd=0.63\n\nValue                                                   |    N | Raw % | Valid % | Cum. %\n-----------------------------------------------------------------------------------------\n1. Senior manager or executive                          |   41 |  1.35 |    1.95 |   1.95\n2. Middle manager (e.g., sector, office or branch head) |  102 |  3.35 |    4.85 |   6.79\n3. Supervisor or foreperson                             |  188 |  6.17 |    8.93 |  15.72\n4. Regular employee or worker (no supervisory role)     | 1774 | 58.20 |   84.28 | 100.00\n<NA>                                                    |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n:::\n\n\n### supervision\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfrq(data$a16)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=2105 mean=-12.08 sd=112.46\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n -999 |    8 |  0.26 |    0.38 |   0.38\n -888 |   24 |  0.79 |    1.14 |   1.52\n    1 |  280 |  9.19 |   13.30 |  14.82\n    2 | 1793 | 58.83 |   85.18 | 100.00\n <NA> |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    supervision = case_when(\n      a16 == 1 ~ 1,\n      a16 %in% c(2, -888, -999) ~ 0,\n      TRUE ~ NA_real_\n    )\n  ) %>%\n  set_variable_labels(supervision = \"Supervises other workers (a16)\")\n\nfrq(data$supervision)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSupervises other workers (a16) (x) <numeric> \n# total N=3048 valid N=2105 mean=0.13 sd=0.34\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n    0 | 1825 | 59.88 |   86.70 |  86.70\n    1 |  280 |  9.19 |   13.30 | 100.00\n <NA> |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n:::\n\n\n### decisionmaking_typology\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfrq(data$a17_01)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=2105 mean=-19.16 sd=140.62\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n -999 |   14 |  0.46 |    0.67 |   0.67\n -888 |   36 |  1.18 |    1.71 |   2.38\n    1 |  101 |  3.31 |    4.80 |   7.17\n    2 |  338 | 11.09 |   16.06 |  23.23\n    3 | 1616 | 53.02 |   76.77 | 100.00\n <NA> |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\nfrq(data$a17_02)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=2105 mean=-16.73 sd=132.62\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n -999 |   10 |  0.33 |    0.48 |   0.48\n -888 |   35 |  1.15 |    1.66 |   2.14\n    1 |   55 |  1.80 |    2.61 |   4.75\n    2 |  223 |  7.32 |   10.59 |  15.34\n    3 | 1782 | 58.46 |   84.66 | 100.00\n <NA> |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\nfrq(data$a17_03)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=2105 mean=-12.16 sd=117.04\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n -999 |   11 |  0.36 |    0.52 |   0.52\n -888 |   23 |  0.75 |    1.09 |   1.62\n    1 |   71 |  2.33 |    3.37 |   4.99\n    2 |  249 |  8.17 |   11.83 |  16.82\n    3 | 1751 | 57.45 |   83.18 | 100.00\n <NA> |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\nfrq(data$a17_04)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=2105 mean=-12.57 sd=118.59\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n -999 |   11 |  0.36 |    0.52 |   0.52\n -888 |   24 |  0.79 |    1.14 |   1.66\n    1 |   56 |  1.84 |    2.66 |   4.32\n    2 |  259 |  8.50 |   12.30 |  16.63\n    3 | 1755 | 57.58 |   83.37 | 100.00\n <NA> |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\nfrq(data$a17_05)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=2105 mean=-9.96 sd=107.12\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n -999 |    7 |  0.23 |    0.33 |   0.33\n -888 |   22 |  0.72 |    1.05 |   1.38\n    1 |  120 |  3.94 |    5.70 |   7.08\n    2 |  418 | 13.71 |   19.86 |  26.94\n    3 | 1538 | 50.46 |   73.06 | 100.00\n <NA> |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\nfrq(data$a17_06)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=2105 mean=-20.39 sd=143.27\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n -999 |    7 |  0.23 |    0.33 |   0.33\n -888 |   47 |  1.54 |    2.23 |   2.57\n    1 |   63 |  2.07 |    2.99 |   5.56\n    2 |  211 |  6.92 |   10.02 |  15.58\n    3 | 1777 | 58.30 |   84.42 | 100.00\n <NA> |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    decisionmaking_typology = if_else(\n      is.na(a17_01),\n      NA_real_,\n      rowSums(across(a17_01:a17_06, ~ case_when(\n        .x == 1 ~ 3,\n        .x == 2 ~ 2,\n        .x == 3 ~ 1,\n        .x %in% c(-888, -999) ~ 1,  \n        TRUE ~ NA_real_\n      )), na.rm = TRUE)\n    ),\n    decisionmaking_typology_mean = if_else(\n      is.na(a17_01),\n      NA_real_,\n      rowMeans(across(a17_01:a17_06, ~ case_when(\n        .x == 1 ~ 3,\n        .x == 2 ~ 2,\n        .x == 3 ~ 1,\n        .x %in% c(-888, -999) ~ 1,\n        TRUE ~ NA_real_\n      )), na.rm = TRUE)\n    )\n  ) %>%\n  set_variable_labels(\n    decisionmaking_typology = \"Decision-making typology (sum, inverted)\",\n    decisionmaking_typology_mean = \"Decision-making typology (mean, inverted)\"\n  )\n\nfrq(data$decisionmaking_typology)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDecision-making typology (sum, inverted) (x) <numeric> \n# total N=3048 valid N=2105 mean=7.25 sd=2.38\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n    6 | 1363 | 44.72 |   64.75 |  64.75\n    7 |  228 |  7.48 |   10.83 |  75.58\n    8 |  139 |  4.56 |    6.60 |  82.19\n    9 |   79 |  2.59 |    3.75 |  85.94\n   10 |   67 |  2.20 |    3.18 |  89.12\n   11 |   61 |  2.00 |    2.90 |  92.02\n   12 |   78 |  2.56 |    3.71 |  95.72\n   13 |   27 |  0.89 |    1.28 |  97.01\n   14 |   11 |  0.36 |    0.52 |  97.53\n   15 |   10 |  0.33 |    0.48 |  98.00\n   16 |   10 |  0.33 |    0.48 |  98.48\n   17 |    5 |  0.16 |    0.24 |  98.72\n   18 |   27 |  0.89 |    1.28 | 100.00\n <NA> |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\nfrq(data$decisionmaking_typology_mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDecision-making typology (mean, inverted) (x) <numeric> \n# total N=3048 valid N=2105 mean=1.21 sd=0.40\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n 1.00 | 1363 | 44.72 |   64.75 |  64.75\n 1.17 |  228 |  7.48 |   10.83 |  75.58\n 1.33 |  139 |  4.56 |    6.60 |  82.19\n 1.50 |   79 |  2.59 |    3.75 |  85.94\n 1.67 |   67 |  2.20 |    3.18 |  89.12\n 1.83 |   61 |  2.00 |    2.90 |  92.02\n 2.00 |   78 |  2.56 |    3.71 |  95.72\n 2.17 |   27 |  0.89 |    1.28 |  97.01\n 2.33 |   11 |  0.36 |    0.52 |  97.53\n 2.50 |   10 |  0.33 |    0.48 |  98.00\n 2.67 |   10 |  0.33 |    0.48 |  98.48\n 2.83 |    5 |  0.16 |    0.24 |  98.72\n 3.00 |   27 |  0.89 |    1.28 | 100.00\n <NA> |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\n# Crear variable con 3 categorías\ndata <- data %>%\n  mutate(\n    decisionmaking_typology_cat = case_when(\n      decisionmaking_typology_mean == 1 ~ 1,\n      decisionmaking_typology_mean > 1 & decisionmaking_typology_mean < 3 ~ 2,\n      decisionmaking_typology_mean == 3 ~ 3\n    ),\n    decisionmaking_typology_cat = factor(\n      decisionmaking_typology_cat,\n      levels = 1:3\n    )\n  ) %>%\n  set_variable_labels(\n    decisionmaking_typology_cat = \"Decision-making typology (recoded 3 categories)\"\n  )\n\nfrq(data$decisionmaking_typology_cat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDecision-making typology (recoded 3 categories) (x) <categorical> \n# total N=3048 valid N=2105 mean=1.37 sd=0.51\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n    1 | 1363 | 44.72 |   64.75 |  64.75\n    2 |  715 | 23.46 |   33.97 |  98.72\n    3 |   27 |  0.89 |    1.28 | 100.00\n <NA> |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n:::\n\n\n### managerial_location_typology\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    managerial_location_typology = case_when(\n      as.integer(decisionmaking_typology_cat) == 3 & supervision == 1 & as.integer(formal_position_auth) %in% 1:3 ~ 1,\n      as.integer(decisionmaking_typology_cat) == 3 & supervision == 1 & as.integer(formal_position_auth) == 4 ~ 2,\n      as.integer(decisionmaking_typology_cat) == 3 & supervision == 0 & as.integer(formal_position_auth) %in% 1:3 ~ 3,\n      as.integer(decisionmaking_typology_cat) == 3 & supervision == 0 & as.integer(formal_position_auth) == 4 ~ 4,\n      as.integer(decisionmaking_typology_cat) == 2 & supervision == 1 & as.integer(formal_position_auth) %in% 1:3 ~ 5,\n      as.integer(decisionmaking_typology_cat) == 2 & supervision == 1 & as.integer(formal_position_auth) == 4 ~ 6,\n      as.integer(decisionmaking_typology_cat) == 2 & supervision == 0 & as.integer(formal_position_auth) %in% 1:3 ~ 7,\n      as.integer(decisionmaking_typology_cat) == 2 & supervision == 0 & as.integer(formal_position_auth) == 4 ~ 8,\n      as.integer(decisionmaking_typology_cat) == 1 & supervision == 1 & as.integer(formal_position_auth) %in% 1:3 ~ 9,\n      as.integer(decisionmaking_typology_cat) == 1 & supervision == 1 & as.integer(formal_position_auth) == 4 ~ 10,\n      as.integer(decisionmaking_typology_cat) == 1 & supervision == 0 & as.integer(formal_position_auth) %in% 1:3 ~ 11,\n      as.integer(decisionmaking_typology_cat) == 1 & supervision == 0 & as.integer(formal_position_auth) == 4 ~ 12\n    ),\n    managerial_location_typology = factor(\n      managerial_location_typology,\n      levels = 1:12,\n      labels = c(\n        \"1. Manager on all criteria\",\n        \"2. Manager not in formal hierarchy\",\n        \"3. Non-supervisory manager\",\n        \"4. Non-supervisory decision-maker not in formal hierarchy\",\n        \"5. Advisor-manager on all criteria\",\n        \"6. Advisor not in hierarchy\",\n        \"7. Non-supervisory advisor\",\n        \"8. Non-supervisory advisor not in formal hierarchy\",\n        \"9. Sanctioning / task supervisor in hierarchy\",\n        \"10. Sanctioning / task supervisor not in hierarchy\",\n        \"11. Not subordinates but in hierarchy\",\n        \"12. Non-supervisor / non manager on all criteria\"\n      )\n    ),\n    organization_assets = case_when(\n      as.integer(managerial_location_typology) %in% c(1, 2, 3, 5) ~ 1,\n      as.integer(managerial_location_typology) %in% c(6, 7, 9, 10) ~ 2,\n      as.integer(managerial_location_typology) %in% c(4, 8, 11, 12) ~ 3\n    ),\n    organization_assets = factor(\n      organization_assets,\n      levels = 1:3,\n      labels = c(\n        \"1. Manager\",\n        \"2. Supervisor\",\n        \"3. Non-managerial worker\"\n      )\n    )\n  ) %>%\n  set_variable_labels(\n    managerial_location_typology = \"Managerial Location Typology\",\n    organization_assets = \"Organizational Assets\"\n  )\n\nfrq(data$managerial_location_typology)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nManagerial Location Typology (x) <categorical> \n# total N=3048 valid N=2105 mean=10.12 sd=2.66\n\nValue                                                     |    N | Raw % | Valid % | Cum. %\n-------------------------------------------------------------------------------------------\n1. Manager on all criteria                                |   18 |  0.59 |    0.86 |   0.86\n2. Manager not in formal hierarchy                        |    4 |  0.13 |    0.19 |   1.05\n3. Non-supervisory manager                                |    4 |  0.13 |    0.19 |   1.24\n4. Non-supervisory decision-maker not in formal hierarchy |    1 |  0.03 |    0.05 |   1.28\n5. Advisor-manager on all criteria                        |  174 |  5.71 |    8.27 |   9.55\n6. Advisor not in hierarchy                               |   67 |  2.20 |    3.18 |  12.73\n7. Non-supervisory advisor                                |   86 |  2.82 |    4.09 |  16.82\n8. Non-supervisory advisor not in formal hierarchy        |  388 | 12.73 |   18.43 |  35.25\n9. Sanctioning / task supervisor in hierarchy             |    7 |  0.23 |    0.33 |  35.58\n10. Sanctioning / task supervisor not in hierarchy        |   10 |  0.33 |    0.48 |  36.06\n11. Not subordinates but in hierarchy                     |   42 |  1.38 |    2.00 |  38.05\n12. Non-supervisor / non manager on all criteria          | 1304 | 42.78 |   61.95 | 100.00\n<NA>                                                      |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\nfrq(data$organization_assets)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOrganizational Assets (x) <categorical> \n# total N=3048 valid N=2105 mean=2.73 sd=0.62\n\nValue                    |    N | Raw % | Valid % | Cum. %\n----------------------------------------------------------\n1. Manager               |  200 |  6.56 |    9.50 |   9.50\n2. Supervisor            |  170 |  5.58 |    8.08 |  17.58\n3. Non-managerial worker | 1735 | 56.92 |   82.42 | 100.00\n<NA>                     |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n:::\n\n\n### boletas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfrq(data$a06)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=3048 mean=-11.58 sd=113.10\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n -999 |   11 |  0.36 |    0.36 |   0.36\n -888 |   36 |  1.18 |    1.18 |   1.54\n    1 |  478 | 15.68 |   15.68 |  17.22\n    2 |  398 | 13.06 |   13.06 |  30.28\n    3 | 2125 | 69.72 |   69.72 | 100.00\n <NA> |    0 |  0.00 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\ntable(data$a06, data$relation_mop)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      \n       1. Employers 2. Self-Employed 3. Salaried\n  -999            1                3           7\n  -888            4                2          30\n  1             131               85         262\n  2              78              122         198\n  3             131              386        1608\n```\n:::\n\n```{.r .cell-code}\ntable(data$a06, data$owners)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      \n       1. Solo Self-Employed 2. Small employers 3. Employers\n  -999                     4                  0            0\n  -888                     0                  2            4\n  1                      107                 65           43\n  2                       89                 90           19\n  3                      351                119           42\n```\n:::\n\n```{.r .cell-code}\ntable(data$a06, data$owners2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      \n       1. Solo Self-Employed 2. Small employers 3. Employers\n  -999                     4                  0            0\n  -888                     0                  2            4\n  1                      107                 99            9\n  2                       89                101            8\n  3                      351                146           15\n```\n:::\n:::\n\n\n### inicio_actividades\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfrq(data$a10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=945 mean=3.14 sd=1.72\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n    1 |  254 |  8.33 |   26.88 |  26.88\n    2 |  192 |  6.30 |   20.32 |  47.20\n    3 |   63 |  2.07 |    6.67 |  53.86\n    4 |   42 |  1.38 |    4.44 |  58.31\n    5 |  394 | 12.93 |   41.69 | 100.00\n <NA> | 2103 | 69.00 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\ntable(data$a10, data$relation_mop)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   \n    1. Employers 2. Self-Employed 3. Salaried\n  1          143              111           0\n  2           63              129           0\n  3           40               23           0\n  4           19               23           0\n  5           80              312           2\n```\n:::\n\n```{.r .cell-code}\ntable(data$a10, data$owners)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   \n    1. Solo Self-Employed 2. Small employers 3. Employers\n  1                   131                 79           43\n  2                    90                 87           14\n  3                    16                 33           13\n  4                    16                 12           13\n  5                   298                 65           25\n```\n:::\n\n```{.r .cell-code}\ntable(data$a10, data$owners2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   \n    1. Solo Self-Employed 2. Small employers 3. Employers\n  1                   131                111           11\n  2                    90                 95            6\n  3                    16                 42            4\n  4                    16                 20            5\n  5                   298                 80           10\n```\n:::\n:::\n\n\n### contrato_escrito \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfrq(data$a18)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nx <numeric> \n# total N=3048 valid N=2105 mean=-13.86 sd=122.43\n\nValue |    N | Raw % | Valid % | Cum. %\n---------------------------------------\n -999 |   32 |  1.05 |    1.52 |   1.52\n    1 | 1691 | 55.48 |   80.33 |  81.85\n    2 |   76 |  2.49 |    3.61 |  85.46\n    3 |  272 |  8.92 |   12.92 |  98.38\n    4 |   34 |  1.12 |    1.62 | 100.00\n <NA> |  943 | 30.94 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\ntable(data$a18, data$relation_mop)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      \n       1. Employers 2. Self-Employed 3. Salaried\n  -999            0                0          32\n  1               0                0        1691\n  2               0                0          76\n  3               0                0         272\n  4               0                0          34\n```\n:::\n\n```{.r .cell-code}\ntabla <- data %>% \n  filter(as.numeric(owners)==1)\n\ntable(tabla$a18, tabla$a06)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n< table of extent 0 x 4 >\n```\n:::\n\n```{.r .cell-code}\ntable(data$a18, data$a06)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      \n       -999 -888    1    2    3\n  -999    1    0   10    3   18\n  1       5   22  193  151 1320\n  2       1    2   13   14   46\n  3       0    4   39   23  206\n  4       0    2    7    7   18\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(data$owners, data$educ)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                       \n                          1   2   3   4   5   6   7   8   9  10\n  1. Solo Self-Employed  11  29  66  61 200  35  57  23  55  10\n  2. Small employers      5  14  28  24  88  13  37  19  39   7\n  3. Employers            1   1   4   5  38   8  13   5  19   1\n```\n:::\n:::\n\n\n## Clases\n\n![](img/wright_classes.jpeg){}\n\n### wrightclass1_original\n\n**employers: employers con 10 o más trabajadores**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    wrightclass1_original = case_when(\n      as.integer(owners) == 3 ~ 1,  # Employers\n      as.integer(owners) == 2 ~ 2,  # Small employers\n      as.integer(owners) == 1 ~ 3,  # Petty bourgeoisie\n      \n      as.integer(organization_assets) == 1 & as.integer(skills) == 1 ~ 4,  # Expert managers\n      as.integer(organization_assets) == 2 & as.integer(skills) == 1 ~ 5,  # Expert supervisors\n      as.integer(organization_assets) == 3 & as.integer(skills) == 1 ~ 6,  # Experts\n      \n      as.integer(organization_assets) == 1 & as.integer(skills) == 2 ~ 7,  # Skilled managers\n      as.integer(organization_assets) == 2 & as.integer(skills) == 2 ~ 8,  # Skilled supervisors\n      as.integer(organization_assets) == 3 & as.integer(skills) == 2 ~ 9,  # Skilled workers\n      \n      as.integer(organization_assets) == 1 & as.integer(skills) == 3 ~ 10, # Nonskilled managers\n      as.integer(organization_assets) == 2 & as.integer(skills) == 3 ~ 11, # Nonskilled supervisors\n      as.integer(organization_assets) == 3 & as.integer(skills) == 3 ~ 12  # Nonskilled workers\n    ),\n    wrightclass1_original = factor(\n      wrightclass1_original,\n      levels = 1:12,\n      labels = c(\n        \"1. Employers\",\n        \"2. Small employers\",\n        \"3. Petty bourgeoisie\",\n        \"4. Expert managers\",\n        \"5. Expert supervisors\",\n        \"6. Experts\",\n        \"7. Skilled managers\",\n        \"8. Skilled supervisors\",\n        \"9. Skilled workers\",\n        \"10. Nonskilled managers\",\n        \"11. Nonskilled supervisors\",\n        \"12. Nonskilled workers\"\n      )\n    )\n  ) %>%\n  set_variable_labels(wrightclass1_original = \"Wright Class Typology\")\n\nfrq(data$wrightclass1_original)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWright Class Typology (x) <categorical> \n# total N=3048 valid N=3028 mean=7.27 sd=3.82\n\nValue                      |   N | Raw % | Valid % | Cum. %\n-----------------------------------------------------------\n1. Employers               | 108 |  3.54 |    3.57 |   3.57\n2. Small employers         | 276 |  9.06 |    9.11 |  12.68\n3. Petty bourgeoisie       | 551 | 18.08 |   18.20 |  30.88\n4. Expert managers         |  92 |  3.02 |    3.04 |  33.92\n5. Expert supervisors      |  44 |  1.44 |    1.45 |  35.37\n6. Experts                 | 245 |  8.04 |    8.09 |  43.46\n7. Skilled managers        |  88 |  2.89 |    2.91 |  46.37\n8. Skilled supervisors     |  79 |  2.59 |    2.61 |  48.98\n9. Skilled workers         | 688 | 22.57 |   22.72 |  71.70\n10. Nonskilled managers    |  20 |  0.66 |    0.66 |  72.36\n11. Nonskilled supervisors |  38 |  1.25 |    1.25 |  73.61\n12. Nonskilled workers     | 799 | 26.21 |   26.39 | 100.00\n<NA>                       |  20 |  0.66 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\n# base survey\ndata_svy <- as_survey_design(data, weights = rake_wb2)\ndata_svy <- data_svy %>%\n  mutate(wrightclass1_original = fct_drop(wrightclass1_original))  # elimina <NA> como nivel\n\n# Tabla de frecuencias ponderadas\nwright_freq <- data_svy %>%\n  group_by(wrightclass1_original) %>%\n  summarise(\n    freq = survey_mean(vartype = NULL, na.rm = TRUE),\n    n_unweighted = unweighted(n())\n  ) %>%\n  mutate(\n    freq_pct = freq * 100\n  )\n\nwright_freq %>%\n  print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 13 × 4\n   wrightclass1_original         freq n_unweighted freq_pct\n   <fct>                        <dbl>        <int>    <dbl>\n 1 1. Employers               0.0187           108    1.87 \n 2 2. Small employers         0.0635           276    6.35 \n 3 3. Petty bourgeoisie       0.145            551   14.5  \n 4 4. Expert managers         0.0279            92    2.79 \n 5 5. Expert supervisors      0.0142            44    1.42 \n 6 6. Experts                 0.0768           245    7.68 \n 7 7. Skilled managers        0.0435            88    4.35 \n 8 8. Skilled supervisors     0.0212            79    2.12 \n 9 9. Skilled workers         0.231            688   23.1  \n10 10. Nonskilled managers    0.00926           20    0.926\n11 11. Nonskilled supervisors 0.00957           38    0.957\n12 12. Nonskilled workers     0.337            799   33.7  \n13 <NA>                       0.00314           20    0.314\n```\n:::\n:::\n\n\n### wrightclass2_capitalists\n\n**capitalists: employers 50 o más trabajadores**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    wrightclass2_capitalists = case_when(\n      as.integer(owners2) == 3 ~ 1,  # Capitalists\n      as.integer(owners2) == 2 ~ 2,  # Small employers\n      as.integer(owners2) == 1 ~ 3,  # Petty bourgeoisie\n      \n      as.integer(organization_assets) == 1 & as.integer(skills) == 1 ~ 4,  # Expert managers\n      as.integer(organization_assets) == 2 & as.integer(skills) == 1 ~ 5,  # Expert supervisors\n      as.integer(organization_assets) == 3 & as.integer(skills) == 1 ~ 6,  # Experts\n      \n      as.integer(organization_assets) == 1 & as.integer(skills) == 2 ~ 7,  # Skilled managers\n      as.integer(organization_assets) == 2 & as.integer(skills) == 2 ~ 8,  # Skilled supervisors\n      as.integer(organization_assets) == 3 & as.integer(skills) == 2 ~ 9,  # Skilled workers\n      \n      as.integer(organization_assets) == 1 & as.integer(skills) == 3 ~ 10, # Nonskilled managers\n      as.integer(organization_assets) == 2 & as.integer(skills) == 3 ~ 11, # Nonskilled supervisors\n      as.integer(organization_assets) == 3 & as.integer(skills) == 3 ~ 12  # Nonskilled workers\n    ),\n    wrightclass2_capitalists = factor(\n      wrightclass2_capitalists,\n      levels = 1:12,\n      labels = c(\n        \"1. Capitalists\",\n        \"2. Small employers\",\n        \"3. Petty bourgeoisie\",\n        \"4. Expert managers\",\n        \"5. Expert supervisors\",\n        \"6. Experts\",\n        \"7. Skilled managers\",\n        \"8. Skilled supervisors\",\n        \"9. Skilled workers\",\n        \"10. Nonskilled managers\",\n        \"11. Nonskilled supervisors\",\n        \"12. Nonskilled workers\"\n      )\n    )\n  ) %>%\n  set_variable_labels(wrightclass2_capitalists = \"Wright Class Typology (2)\")\n\nfrq(data$wrightclass2_capitalists)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWright Class Typology (2) (x) <categorical> \n# total N=3048 valid N=3028 mean=7.29 sd=3.79\n\nValue                      |   N | Raw % | Valid % | Cum. %\n-----------------------------------------------------------\n1. Capitalists             |  36 |  1.18 |    1.19 |   1.19\n2. Small employers         | 348 | 11.42 |   11.49 |  12.68\n3. Petty bourgeoisie       | 551 | 18.08 |   18.20 |  30.88\n4. Expert managers         |  92 |  3.02 |    3.04 |  33.92\n5. Expert supervisors      |  44 |  1.44 |    1.45 |  35.37\n6. Experts                 | 245 |  8.04 |    8.09 |  43.46\n7. Skilled managers        |  88 |  2.89 |    2.91 |  46.37\n8. Skilled supervisors     |  79 |  2.59 |    2.61 |  48.98\n9. Skilled workers         | 688 | 22.57 |   22.72 |  71.70\n10. Nonskilled managers    |  20 |  0.66 |    0.66 |  72.36\n11. Nonskilled supervisors |  38 |  1.25 |    1.25 |  73.61\n12. Nonskilled workers     | 799 | 26.21 |   26.39 | 100.00\n<NA>                       |  20 |  0.66 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\n# base survey\ndata_svy <- as_survey_design(data, weights = rake_wb2)\ndata_svy <- data_svy %>%\n  mutate(wrightclass2_capitalists = fct_drop(wrightclass2_capitalists))  # elimina <NA> como nivel\n\n# Tabla de frecuencias ponderadas\nwright_freq_2 <- data_svy %>%\n  group_by(wrightclass2_capitalists) %>%\n  summarise(\n    freq = survey_mean(vartype = NULL, na.rm = TRUE),\n    n_unweighted = unweighted(n())\n  ) %>%\n  mutate(\n    freq_pct = freq * 100\n  )\n\nwright_freq_2 %>%\n  print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 13 × 4\n   wrightclass2_capitalists      freq n_unweighted freq_pct\n   <fct>                        <dbl>        <int>    <dbl>\n 1 1. Capitalists             0.00897           36    0.897\n 2 2. Small employers         0.0732           348    7.32 \n 3 3. Petty bourgeoisie       0.145            551   14.5  \n 4 4. Expert managers         0.0279            92    2.79 \n 5 5. Expert supervisors      0.0142            44    1.42 \n 6 6. Experts                 0.0768           245    7.68 \n 7 7. Skilled managers        0.0435            88    4.35 \n 8 8. Skilled supervisors     0.0212            79    2.12 \n 9 9. Skilled workers         0.231            688   23.1  \n10 10. Nonskilled managers    0.00926           20    0.926\n11 11. Nonskilled supervisors 0.00957           38    0.957\n12 12. Nonskilled workers     0.337            799   33.7  \n13 <NA>                       0.00314           20    0.314\n```\n:::\n:::\n\n\n### wrightclass1_informal\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(\n    wrightclass1_informal = case_when(\n      as.integer(owners) == 3 ~ 1,  # 1. Employers\n      \n      as.integer(owners) == 2 ~ 2,  # 2. Small employers\n      \n      as.integer(owners) == 1 & a06 %in% c(1, 2) ~ 3,   # 3. Petty bourgeoisie\n      as.integer(owners) == 1 & a06 %in% c(3, -888, -999) ~ 4,  # 4. Informal self-employed\n      \n      as.integer(organization_assets) == 1 & as.integer(skills) == 1 ~ 5, # 5. Expert managers\n      as.integer(organization_assets) == 2 & as.integer(skills) == 1 ~ 6,  # 6. Expert supervisors\n      as.integer(organization_assets) == 3 & as.integer(skills) == 1 ~ 7,  # 7. Experts\n      \n      as.integer(organization_assets) == 1 & as.integer(skills) == 2 ~ 8,  # 8. Skilled managers\n      as.integer(organization_assets) == 2 & as.integer(skills) == 2 ~ 9,  # 9. skilled supervisors\n      \n      as.integer(organization_assets) == 1 & as.integer(skills) == 3 ~ 10, # 10. Nonskilled managers\n      as.integer(organization_assets) == 2 & as.integer(skills) == 3 ~ 11, # 11. Nonskilled supervisors\n      \n      as.integer(organization_assets) == 3 & as.integer(skills) %in% c(2, 3) & a18 == 1 ~ 12,             # 12. Formal workers\n      as.integer(organization_assets) == 3 & as.integer(skills) %in% c(2, 3) & a18 %in% c(2, 3, 4, -999) ~ 13  # 13. Informal workers\n    ),\n    wrightclass1_informal = factor(\n      wrightclass1_informal,\n      levels = 1:13,\n      labels = c(\n        \"1. Employers\",\n        \"2. Small employers\",\n        \"3. Petty bourgeoisie\",\n        \"4. Informal self-employed\",\n        \"5. Expert managers\",\n        \"6. Expert supervisors\",\n        \"7. Experts\",\n        \"8. Skilled managers\",\n        \"9. Skilled supervisors\",\n        \"10. Nonskilled managers\",\n        \"11. Nonskilled supervisors\",\n        \"12. Formal workers\",\n        \"13. Informal workers\"\n      )\n    )\n  ) %>%\n  set_variable_labels(wrightclass1_informal = \"Wright Class Typology (3)\")\n\nfrq(data$wrightclass1_informal)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWright Class Typology (3) (x) <categorical> \n# total N=3048 valid N=3028 mean=8.36 sd=4.22\n\nValue                      |    N | Raw % | Valid % | Cum. %\n------------------------------------------------------------\n1. Employers               |  108 |  3.54 |    3.57 |   3.57\n2. Small employers         |  276 |  9.06 |    9.11 |  12.68\n3. Petty bourgeoisie       |  196 |  6.43 |    6.47 |  19.15\n4. Informal self-employed  |  355 | 11.65 |   11.72 |  30.88\n5. Expert managers         |   92 |  3.02 |    3.04 |  33.92\n6. Expert supervisors      |   44 |  1.44 |    1.45 |  35.37\n7. Experts                 |  245 |  8.04 |    8.09 |  43.46\n8. Skilled managers        |   88 |  2.89 |    2.91 |  46.37\n9. Skilled supervisors     |   79 |  2.59 |    2.61 |  48.98\n10. Nonskilled managers    |   20 |  0.66 |    0.66 |  49.64\n11. Nonskilled supervisors |   38 |  1.25 |    1.25 |  50.89\n12. Formal workers         | 1150 | 37.73 |   37.98 |  88.87\n13. Informal workers       |  337 | 11.06 |   11.13 | 100.00\n<NA>                       |   20 |  0.66 |    <NA> |   <NA>\n```\n:::\n\n```{.r .cell-code}\n# base survey\ndata_svy <- as_survey_design(data, weights = rake_wb2)\n# data_svy <- data_svy %>%\n#   mutate(wrightclass1_informal = fct_drop(wrightclass1_informal))  # elimina <NA> como nivel\n\n# Tabla de frecuencias ponderadas\nwright_freq_3 <- data_svy %>%\n  group_by(wrightclass1_informal) %>%\n  summarise(\n    freq = survey_mean(vartype = NULL, na.rm = TRUE),\n    n_unweighted = unweighted(n())\n  ) %>%\n  mutate(\n    freq_pct = freq * 100\n  )\n\nwright_freq_3 %>%\n  print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 14 × 4\n   wrightclass1_informal         freq n_unweighted freq_pct\n   <fct>                        <dbl>        <int>    <dbl>\n 1 1. Employers               0.0187           108    1.87 \n 2 2. Small employers         0.0635           276    6.35 \n 3 3. Petty bourgeoisie       0.0541           196    5.41 \n 4 4. Informal self-employed  0.0908           355    9.08 \n 5 5. Expert managers         0.0279            92    2.79 \n 6 6. Expert supervisors      0.0142            44    1.42 \n 7 7. Experts                 0.0768           245    7.68 \n 8 8. Skilled managers        0.0435            88    4.35 \n 9 9. Skilled supervisors     0.0212            79    2.12 \n10 10. Nonskilled managers    0.00926           20    0.926\n11 11. Nonskilled supervisors 0.00957           38    0.957\n12 12. Formal workers         0.435           1150   43.5  \n13 13. Informal workers       0.133            337   13.3  \n14 <NA>                       0.00314           20    0.314\n```\n:::\n:::\n\n\n### wrightclass2_informal\n\n\n::: {.cell}\n\n:::\n\n\n### nuevo esquema de clases invertido\n\n1. formal workers\n2. informal workers\n3. \n\n4. managers todos los managers \n\n5. supervisors todos los supervisores\n\n6. experts\n\n7. pequeña burguesía \n\n8. small employers\n\n9. employers 10 o más\n\n\n\n- variables dependientes\n\nc01 todas actitudes hacia los sindicatos, con 888 999 como NA\nc07_03 gobierno más poder a los sindicatos, 888 999 como NA\nc07_03_dummy 1== muy de acuerdo, de acuerdo , 0 = todo el resto incluyendo NA\nb29 1 == tal vez, prob si y definitivamente si, 0 == todo el resto\n\n- controles\n\nsexo 1== mujer\nedad en años\nsector 1== privado\nrama agrupada\naf_sindical 1== si\nid_politica en 4 cat\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}